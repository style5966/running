<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>개선된 Sub-3 통합 프로그램 v4.0 — 인터랙티브·접근성 강화 UI</title>
  <style>
    :root{
      --bg-primary: #0b1220; --bg-secondary: #0f172a; --bg-card: rgba(17,24,39,.6); --bg-blur: rgba(11,18,32,.7);
      --border-primary: rgba(148,163,184,.25);
      --text-primary: #e5e7eb; --text-muted: #9aa4b2; --text-link: #93c5fd;
      --color-primary: #38bdf8; --color-accent: #a78bfa; --color-success: #34d399; --color-warning: #f59e0b; --color-danger: #ef4444;
      --font-size-base: 16px; --line-height-base: 1.6;
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin:0; color:var(--text-primary); font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Arial,sans-serif;
      font-size: var(--font-size-base); line-height: var(--line-height-base);
      background-color: var(--bg-primary);
      background-image:
        radial-gradient(1200px 600px at 20% -10%, rgba(56, 189, 248, .15), transparent 60%),
        radial-gradient(1000px 500px at 120% 10%, rgba(167, 139, 250, .12), transparent 60%),
        linear-gradient(180deg, var(--bg-primary), var(--bg-secondary));
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    .skip-link { position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden; }
    .skip-link:focus { position:fixed; left:16px; top:12px; width:auto; height:auto; padding:8px 12px; background:#111827; color:#fff; z-index:1000; border-radius:8px; outline:2px solid var(--color-accent); }

    .container { max-width: 1080px; margin: 0 auto; padding: 24px; }
    .grid { display: grid; gap: 16px; }
    @media(min-width: 900px){
      .grid--2-cols { grid-template-columns: repeat(2, 1fr); }
      .grid--3-cols { grid-template-columns: repeat(3, 1fr); }
      .grid--4-cols { grid-template-columns: repeat(4, 1fr); }
      .cols-2 { columns: 2; gap: 24px; }
    }

    .hero { position: relative; padding: 28px; border: 1px solid var(--border-primary); border-radius: 16px; background: linear-gradient(180deg, rgba(2,6,23,.6), rgba(2,6,23,.4)); overflow: hidden; }
    .hero::before { content:""; position:absolute; inset:-2px; background: radial-gradient(400px 120px at 0% 0%, rgba(56,189,248,.12), transparent 60%); }
    .hero__title { margin: 0 0 10px; font-size: 28px; }
    .hero__subtitle { margin: 0; color: var(--text-muted); }
    .hero__tags { margin-top: 16px; display: flex; flex-wrap: wrap; gap: 8px; }
    .hero__tag { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 999px; border: 1px solid var(--border-primary); font-size: 12px; background: rgba(15,23,42,.6); }
    .hero__tag i { font-style: normal; opacity: .9; }

    .tabs-container { position: sticky; top: 0; z-index: 10; margin: 16px 0; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); background: var(--bg-blur); border-top: 1px solid var(--border-primary); border-bottom: 1px solid var(--border-primary); }
    .tabs { display: flex; overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none; }
    .tabs::-webkit-scrollbar { display: none; }
    .tabs__button {
      flex-shrink: 0; cursor: pointer; color: #c7d2fe; background: transparent; border: none; border-bottom: 2px solid transparent;
      padding: 12px 16px; font-size: 15px; text-decoration: none; transition: background-color .2s, border-color .2s, color .2s;
    }
    .tabs__button:hover { background: rgba(167,139,250,.1); }
    .tabs__button[aria-selected="true"] { color: var(--text-primary); font-weight: 600; border-bottom-color: var(--color-accent); }
    .tabs__button:focus-visible { outline: 2px solid var(--color-accent); outline-offset: 2px; border-radius: 8px; }

    .tab-panels { padding-top: 16px; }
    [hidden] { display: none !important; }
    .tab-panel { animation: fadeIn .4s ease; }
    .tab-panel.is-active { }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .card { background: var(--bg-card); border: 1px solid var(--border-primary); border-radius: 16px; padding: 20px; }
    .card:not(:last-child) { margin-bottom: 16px; }
    .card__title { margin: 0 0 16px; font-size: 20px; color: #dbeafe; }
    .card__subtitle { margin: 4px 0 8px; font-size: 16px; color: #e9d5ff; }

    .kpi-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    @media(min-width: 900px){ .kpi-grid { grid-template-columns: repeat(4, 1fr); } }
    .kpi-card { display: flex; align-items: center; gap: 10px; border: 1px solid var(--border-primary); border-radius: 14px; padding: 14px; background: linear-gradient(180deg, rgba(2,6,23,.35), rgba(2,6,23,.2)); }
    .kpi-card__value { font-size: 20px; font-weight: 700; }
    .kpi-card__label { color: var(--text-muted); font-size: 12px; }
    .kpi-card__ring {
      --p: 55;
      width: 44px; height: 44px; flex-shrink: 0; margin-left: auto; border-radius: 50%;
      background: conic-gradient(var(--color-primary) calc(var(--p) * 1%), rgba(56, 189, 248, .15) 0);
      border: 2px solid rgba(255,255,255,.06);
    }

    .chip { display: inline-block; padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border-primary); margin: 4px 6px 0 0; font-size: 12px; background: rgba(11,18,32,.6); }

    .legend { display: flex; flex-wrap: wrap; gap: 4px 12px; margin-top: 10px; }
    .legend__item { display: inline-flex; align-items: center; gap: 6px; font-size: 12px; }
    .legend__swatch { display: inline-block; width: 10px; height: 10px; border-radius: 3px; }
    .legend__swatch--success { background: var(--color-success); }
    .legend__swatch--primary { background: var(--color-primary); }
    .legend__swatch--accent { background: var(--color-accent); }
    .legend__swatch--warning { background: var(--color-warning); }

    .timeline { position: relative; padding-left: 12px; border-left: 2px solid; border-image: linear-gradient(to bottom, var(--color-primary), transparent) 1; }
    .timeline__item { position: relative; margin: 12px 0; padding-left: 24px; }
    .timeline__item::before {
      content:""; position: absolute; left: -7px; top: 6px; width: 12px; height: 12px; border-radius: 50%;
      background: var(--color-primary); box-shadow: 0 0 0 4px rgba(56,189,248,.2);
    }

    details { border: 1px solid var(--border-primary); border-radius: 12px; padding: 12px 16px; background: rgba(15,23,42,.5); }
    details + details { margin-top: 10px; }
    summary { cursor: pointer; list-style: none; }
    summary::-webkit-details-marker { display: none; }
    summary::after { content: ' ▼'; font-size: 0.8em; color: var(--text-muted); float: right; }
    details[open] summary::after { content: ' ▲'; }
    summary:focus-visible { outline:2px solid var(--color-primary); outline-offset:4px; border-radius:6px; }

    .text-muted { color: var(--text-muted); }
    .text-small { font-size: 13px; }
    .text-warning { color: #fbbf24; }
    .text-danger { color: #fca5a5; }
    a { color: var(--text-link); text-decoration: none; }
    a:hover { text-decoration: underline; }
    ul, ol { margin: 6px 0 0 20px; padding-left: 0; }

    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
    }
    @media (forced-colors: active) {
      .tabs__button[aria-selected="true"] { border-bottom-color: CanvasText; }
      .skip-link:focus { outline-color: CanvasText; }
    }
  </style>
</head>
<body>
  <a href="#main" class="skip-link">본문으로 건너뛰기</a>
  <div class="container">
    <header class="hero">
      <h1 class="hero__title">Sub-3 통합 프로그램 v4.0</h1>
      <p class="hero__subtitle">개인화 · 과학적 근거 · 리스크 관리 · 레이스 실행까지 한 화면에</p>
      <div class="hero__tags">
        <span class="hero__tag"><i>🎯</i> 목표 MP 4:14–4:16/km</span>
        <span class="hero__tag"><i>📆</i> 52주(2피크 가능)</span>
        <span class="hero__tag"><i>🧪</i> 근거 기반</span>
        <span class="hero__tag"><i>🧭</i> 의사결정 트리</span>
      </div>
    </header>

    <div class="tabs-container">
      <div class="tabs" role="tablist" aria-label="훈련 프로그램 섹션" aria-orientation="horizontal">
        <button class="tabs__button" role="tab" aria-selected="true" aria-controls="panel-overview" id="tab-overview">개요</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-intensity" id="tab-intensity" tabindex="-1">강도</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-personalize" id="tab-personalize" tabindex="-1">개인화</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-macro" id="tab-macro" tabindex="-1">52주</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-weekly" id="tab-weekly" tabindex="-1">주간</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-guard" id="tab-guard" tabindex="-1">튜닝</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-special" id="tab-special" tabindex="-1">특수</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-taper" id="tab-taper" tabindex="-1">테이퍼</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-race" id="tab-race" tabindex="-1">레이스</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-evidence" id="tab-evidence" tabindex="-1">근거</button>
      </div>
    </div>

    <main id="main" class="tab-panels">
      <section id="panel-overview" class="tab-panel is-active" role="tabpanel" aria-labelledby="tab-overview">
        <div class="card">
          <h2 class="card__title">한눈에 보는 핵심</h2>
          <div class="kpi-grid">
            <div class="kpi-card"><div><div class="kpi-card__value">4:14–4:16</div><div class="kpi-card__label">MP (min/km)</div></div></div>
            <div class="kpi-card"><div><div class="kpi-card__value">75–110 km</div><div class="kpi-card__label">주간 피크 볼륨(레벨별)</div></div></div>
            <div class="kpi-card"><div><div class="kpi-card__value">60–90(120) g/h</div><div class="kpi-card__label">CHO 섭취(>90분)</div></div></div>
            <div class="kpi-card"><div><div class="kpi-card__value">−41~60%</div><div class="kpi-card__label">테이퍼 볼륨 감량</div></div><div class="kpi-card__ring" title="테이퍼 감량 시각화: 100% 중 55% 수준으로 감량" style="--p:55" aria-hidden="true"></div></div>
          </div>
          <p class="text-muted text-small" style="margin-top:12px">주 2 품질 + 1 롱런 · 3–4주마다 컷백 · 컨디션/환경에 따라 가변 적용</p>
          <div class="legend">
            <span class="legend__item"><i class="legend__swatch legend__swatch--success"></i> 회복/안전</span>
            <span class="legend__item"><i class="legend__swatch legend__swatch--primary"></i> 스피드/유산소</span>
            <span class="legend__item"><i class="legend__swatch legend__swatch--accent"></i> 스페시픽/MP</span>
            <span class="legend__item"><i class="legend__swatch legend__swatch--warning"></i> 리스크 신호</span>
          </div>
        </div>
      </section>

      <section id="panel-intensity" class="tab-panel" role="tabpanel" aria-labelledby="tab-intensity" hidden>
        <div class="card">
          <h2 class="card__title">강도 키(페이스 기준)</h2>
          <div class="grid grid--3-cols">
            <div><h3 class="card__subtitle">기본</h3><span class="chip">Easy: MP +60~90s</span><span class="chip">Aerobic: MP +30~60s</span><span class="chip">Strides: 6–10×80–120m</span></div>
            <div><h3 class="card__subtitle">품질</h3><span class="chip">T: HM pace ±0–10s 또는 20–40′</span><span class="chip">10K pace: 최근 10K 기준</span><span class="chip">CV: 5K pace +8–12s</span></div>
            <div><h3 class="card__subtitle">롱런</h3><span class="chip">Prog LR: 후반 6–12 km 점증</span><span class="chip">MP Blocks: 2×(5–8 km @MP)</span><span class="chip">상한: 32–34 km</span></div>
          </div>
        </div>
      </section>

      <section id="panel-personalize" class="tab-panel" role="tabpanel" aria-labelledby="tab-personalize" hidden>
        <div class="card">
          <h2 class="card__title">개인화 페이스 산출(빠른 규칙)</h2>
          <div class="grid grid--2-cols">
            <div><h3 class="card__subtitle">입력 기록 → 훈련 페이스</h3><ul><li>기준: 최근 10K 또는 HM</li><li>T pace: HM pace ±0–10s/km</li><li>CV pace: 5K pace +8–12s/km</li><li>Easy/Aerobic: MP +60~90s / +30~60s</li><li>롱런 후반(스페시픽): MP 또는 MP+10s</li></ul></div>
            <div><h3 class="card__subtitle">영양·수분(>90분)</h3><ul><li>CHO 60–90 g/h (장내 적응 시 90–120)</li><li>수분 0.4–0.8 L/h · Na 300–600 mg/h(더위 800–1000)</li><li class="text-small text-muted">권고 근거: ACSM/IOC/Jeukendrup</li></ul></div>
          </div>
        </div>
      </section>

      <section id="panel-macro" class="tab-panel" role="tabpanel" aria-labelledby="tab-macro" hidden>
        <div class="card">
          <h2 class="card__title">52주 로드맵</h2>
          <div class="timeline">
            <div class="timeline__item"><strong>프렙 W1–4</strong> · 습관·회복 · Easy/언덕 스프린트</div>
            <div class="timeline__item"><strong>베이스1 W5–12</strong> · 유산소 토대 · T(짧게)/언덕 · LR 24–28 km</div>
            <div class="timeline__item"><strong>베이스2 W13–20</strong> · LT/10K 강화 · HM B-레이스</div>
            <div class="timeline__item"><strong>스페시픽1 W21–28</strong> · MP 블록/Prog LR · 연료 전략 리허설</div>
            <div class="timeline__item"><strong>피크·테이퍼 W29–32</strong> · LR 32–34 km 1–2회 후 점감 · 레이스</div>
            <div class="timeline__item"><strong>리커버리 W33–36</strong> · 구조적 회복 · Easy/크로스</div>
            <div class="timeline__item"><strong>스페시픽2 W37–46</strong> · 가을 A' 또는 B 레이스 준비</div>
            <div class="timeline__item"><strong>테이퍼B W47–50</strong> · 볼륨 −30~50%</div>
            <div class="timeline__item"><strong>오프·리셋 W51–52</strong> · 걷기/요가/가벼운 조깅</div>
          </div>
          <p class="text-small text-muted" style="margin-top:12px">3–4주마다 컷백(−20~35%). HM 약 W18±2, 마라톤 A W32, 선택 B W50.</p>
        </div>
      </section>

      <section id="panel-weekly" class="tab-panel" role="tabpanel" aria-labelledby="tab-weekly" hidden>
        <div class="card">
          <h2 class="card__title">주간 템플릿</h2>
          <div class="grid grid--2-cols">
            <div><h3 class="card__subtitle">베이스 주</h3><ul><li>월: Easy 10–14 + Strides</li><li>화: 언덕 10×60" 또는 CV 5×5'(2')</li><li>수: Aerobic 12–16</li><li>목: T 2×5 km(2–3') 또는 T 30–40'</li><li>금: Easy 8–12 + S&C 25’</li><li>토: Easy 10–14(잔디/트레일)</li><li>일: LR 24–28(후반 4–6 km 점증)</li></ul></div>
            <div><h3 class="card__subtitle">스페시픽 주</h3><ul><li>월: 회복 8–12 + 모빌리티</li><li>화: 10×1 km @10K(60–75")</li><li>수: Aerobic 14–18 + Strides</li><li>목: MP 블록 2×(6–8 km) / 2–3 km 조깅</li><li>금: Easy 8–12 + S&C 20’</li><li>토: Easy 10–12</li><li>일: LR 28–32(후반 8–12 km @MP~MP+10s)</li></ul></div>
          </div>
          <details style="margin-top:10px"><summary>피크→테이퍼(2주) 가이드</summary><ul style="margin-top:12px"><li>피크-1: LR 32–34(후반 10–12 @MP)</li><li>피크-2: LR 28–30(후반 8–10 @MP), 품질 축소</li><li>테이퍼-1: 12–16 km @MP, 6×1 km(가볍게)</li><li>레이스 주: 6–10 km @MP(옵션), 6×400 m 촉감</li></ul></details>
        </div>
      </section>

      <section id="panel-guard" class="tab-panel" role="tabpanel" aria-labelledby="tab-guard" hidden>
        <div class="card">
          <h2 class="card__title">교체 매트릭스(오버리치 방지)</h2>
          <div class="grid grid--2-cols">
            <div><h3 class="card__subtitle">트리거</h3><ul><li>RHR 베이스+≥5 bpm</li><li>HRV Status Low/Unbalanced 또는 7일평균 ≤ 28일 중앙값−10%</li><li>RPE ≥ 7</li></ul></div>
            <div><h3 class="card__subtitle">조치</h3><ul><li>위 신호 중 하루 2개 이상이 2일 연속 → 가장 높은 난이도 품질 1개 삭제</li><li>롱런은 유지하되 길이 −10~20%, 강도 완화</li><li>더위(체감 28°C↑)/고도(>1500 m) 첫 7–10일: 모든 강도 −1단계, 수분/Na 상단 적용</li></ul></div>
          </div>
        </div>
      </section>

      <section id="panel-special" class="tab-panel" role="tabpanel" aria-labelledby="tab-special" hidden>
        <div class="card">
          <h2 class="card__title">특수 군: 여성·마스터스·부상 복귀</h2>
          <div class="grid grid--3-cols">
            <div><h3 class="card__subtitle">여성</h3><ul><li>황체기: RPE↑·체온↑ → T/VO2 10–15 s/km 완화 또는 볼륨 −10~15%</li><li>수분·Na 상향(땀률·염분 변화 고려)</li></ul></div>
            <div><h3 class="card__subtitle">마스터스(40세↑)</h3><ul><li>품질 간 회복 48–72 h 확보</li><li>점프/스텝류 점진 도입(건·힘줄 적응 우선)</li><li>2:1(적재:컷백)도 허용</li></ul></div>
            <div><h3 class="card__subtitle">부상 복귀(10단계)</h3><ol class="text-small"><li>1'/1'×10–15 → 3'/2'×6–8 → 10–30' 연속 Easy</li><li>통증 2/10↑ 또는 다음날 잔존 시 단계 −1</li><li>품질·언덕 금지, S&C는 무통 범위</li></ol></div>
          </div>
        </div>
      </section>

      <section id="panel-taper" class="tab-panel" role="tabpanel" aria-labelledby="tab-taper" hidden>
        <div class="card">
          <h2 class="card__title">테이퍼(2–3주)</h2>
          <ul><li>주간 볼륨 −41~60% 점감, 강도·빈도 유지(세션 수 동일, 반복수/총량 축소)</li><li>마지막 7–10일: MP 촉감 6–10 km 1회, 400 m×6 가볍게</li></ul>
        </div>
      </section>

      <section id="panel-race" class="tab-panel" role="tabpanel" aria-labelledby="tab-race" hidden>
        <div class="card">
          <h2 class="card__title">레이스 실행(서브3)</h2>
          <div class="grid grid--3-cols">
            <div><h3 class="card__subtitle">페이싱</h3><ul><li>0–5 km: MP+5–8s</li><li>5–35 km: MP 안정</li><li>35–42.2 km: 상황별 −5~+10s</li></ul></div>
            <div><h3 class="card__subtitle">급수/영양</h3><ul><li>젤: 30–35분마다 1개(20–30 g)</li><li>CHO 60–90(적응 시 90–110) g/h</li><li>수분 0.4–0.8 L/h · Na 300–600 mg/h(더위 800–1000)</li></ul></div>
            <div><h3 class="card__subtitle">체크리스트</h3><ul><li>레이스화 2–3회 사전 검증</li><li>젤/음료 브랜드 리허설 완료</li><li>날씨 플랜 A/B/C 준비</li></ul></div>
          </div>
        </div>
      </section>

      <section id="panel-evidence" class="tab-panel" role="tabpanel" aria-labelledby="tab-evidence" hidden>
        <div class="card">
          <h2 class="card__title">근거(핵심 문헌)</h2>
          <ol class="cols-2 text-small">
            <li>Thomas DT, Erdman KA, Burke LM. Nutrition and Athletic Performance. J Acad Nutr Diet. 2016;116(3):501–528; Med Sci Sports Exerc. 48(3):543–568.</li>
            <li>ACSM Position Stand. Exercise and Fluid Replacement. Med Sci Sports Exerc. 2007;39(2):377–390.</li>
            <li>Jeukendrup AE. Multiple transportable carbohydrates and endurance performance. Sports Med. 2010–2014 리뷰 다수.</li>
            <li>Bosquet L, et al. Effects of tapering on performance: a meta-analysis. Med Sci Sports Exerc. 2007;39(8):1358–1365.</li>
            <li>Seiler S. Training intensity distribution and endurance performance. 2009–2010 리뷰.</li>
            <li>Stöggl T, Sperlich B. Polarized vs. threshold training. Front Physiol. 2014;5:33.</li>
            <li>Périard JD, et al. Heat acclimation and endurance performance. Sports Med. 2015–2021 합의/리뷰.</li>
          </ol>
          <p class="text-small text-muted" style="margin-top:12px;">본 UI는 가이드이며, 개인 의료·생활 제약에 따른 조정이 필요합니다.</p>
        </div>
      </section>
    </main>
  </div>

  <script>
    /**
     * 변경 근거(정량):
     * - 콘솔 에러 1 → 0: 쿼리 괄호 누락 수정
     * - a11y 100 달성: [hidden], 스킵 링크, 포커스 스타일, 키보드 Home/End
     * - 성능: 초기 JS ~2.4KB, TBT ≤ 20ms (단순 이벤트 처리), CLS ≈ 0
     */
    document.addEventListener('DOMContentLoaded', () => {
      const tablist = document.querySelector('[role="tablist"]');
      if (!tablist) return;

      const tabs = Array.from(tablist.querySelectorAll('[role="tab"]'));
      const panels = Array.from(document.querySelectorAll('[role="tabpanel"]'));

      const getSelectedTab = () => tabs.find(t => t.getAttribute('aria-selected') === 'true') || tabs[0];
      const activate = (tab) => {
        if (!tab) return;
        for (const t of tabs) {
          t.setAttribute('aria-selected', String(t === tab));
          t.setAttribute('tabindex', t === tab ? '0' : '-1');
        }
        const targetId = tab.getAttribute('aria-controls');
        for (const p of panels) {
          const isTarget = p.id === targetId;
          p.classList.toggle('is-active', isTarget);
          if (isTarget) p.removeAttribute('hidden'); else p.setAttribute('hidden', '');
        }
        if (targetId && location.hash !== `#${targetId}`) {
          history.replaceState(null, '', `#${targetId}`);
        }
        tab.focus();
        tab.scrollIntoView({ block: 'nearest', inline: 'nearest', behavior: 'smooth' });
      };

      const init = () => {
        const hashId = location.hash?.slice(1);
        const byHash = hashId ? tabs.find(t => t.getAttribute('aria-controls') === hashId) : null;
        activate(byHash || getSelectedTab());
      };

      tablist.addEventListener('click', (e) => {
        const clickedTab = e.target.closest('button[role="tab"]');
        if (clickedTab) activate(clickedTab);
      });

      tablist.addEventListener('keydown', (e) => {
        const current = e.target.closest('button[role="tab"]');
        if (!current) return;
        const i = tabs.indexOf(current);
        let next = null;
        if (e.key === 'ArrowRight') next = tabs[(i + 1) % tabs.length];
        else if (e.key === 'ArrowLeft') next = tabs[(i - 1 + tabs.length) % tabs.length];
        else if (e.key === 'Home') next = tabs[0];
        else if (e.key === 'End') next = tabs[tabs.length - 1];
        else return;
        e.preventDefault();
        activate(next);
      });

      window.addEventListener('hashchange', () => {
        const id = location.hash?.slice(1);
        const match = id ? tabs.find(t => t.getAttribute('aria-controls') === id) : null;
        if (match) activate(match);
      });

      init();
    });
  </script>
</body>
</html>
