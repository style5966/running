<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Í∞úÏÑ†Îêú Sub-3 ÌÜµÌï© ÌîÑÎ°úÍ∑∏Îû® v4.0 ‚Äî Ïù∏ÌÑ∞ÎûôÌã∞Î∏å¬∑Ï†ëÍ∑ºÏÑ± Í∞ïÌôî UI</title>
  <style>
    :root{
      --bg-primary: #0b1220; --bg-secondary: #0f172a; --bg-card: rgba(17,24,39,.6); --bg-blur: rgba(11,18,32,.7);
      --border-primary: rgba(148,163,184,.25);
      --text-primary: #e5e7eb; --text-muted: #9aa4b2; --text-link: #93c5fd;
      --color-primary: #38bdf8; --color-accent: #a78bfa; --color-success: #34d399; --color-warning: #f59e0b; --color-danger: #ef4444;
      --font-size-base: 16px; --line-height-base: 1.6;
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin:0; color:var(--text-primary); font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Arial,sans-serif;
      font-size: var(--font-size-base); line-height: var(--line-height-base);
      background-color: var(--bg-primary);
      background-image:
        radial-gradient(1200px 600px at 20% -10%, rgba(56, 189, 248, .15), transparent 60%),
        radial-gradient(1000px 500px at 120% 10%, rgba(167, 139, 250, .12), transparent 60%),
        linear-gradient(180deg, var(--bg-primary), var(--bg-secondary));
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    .skip-link { position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden; }
    .skip-link:focus { position:fixed; left:16px; top:12px; width:auto; height:auto; padding:8px 12px; background:#111827; color:#fff; z-index:1000; border-radius:8px; outline:2px solid var(--color-accent); }

    .container { max-width: 1080px; margin: 0 auto; padding: 24px; }
    .grid { display: grid; gap: 16px; }
    @media(min-width: 900px){
      .grid--2-cols { grid-template-columns: repeat(2, 1fr); }
      .grid--3-cols { grid-template-columns: repeat(3, 1fr); }
      .grid--4-cols { grid-template-columns: repeat(4, 1fr); }
      .cols-2 { columns: 2; gap: 24px; }
    }

    .hero { position: relative; padding: 28px; border: 1px solid var(--border-primary); border-radius: 16px; background: linear-gradient(180deg, rgba(2,6,23,.6), rgba(2,6,23,.4)); overflow: hidden; }
    .hero::before { content:""; position:absolute; inset:-2px; background: radial-gradient(400px 120px at 0% 0%, rgba(56,189,248,.12), transparent 60%); }
    .hero__title { margin: 0 0 10px; font-size: 28px; }
    .hero__subtitle { margin: 0; color: var(--text-muted); }
    .hero__tags { margin-top: 16px; display: flex; flex-wrap: wrap; gap: 8px; }
    .hero__tag { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 999px; border: 1px solid var(--border-primary); font-size: 12px; background: rgba(15,23,42,.6); }
    .hero__tag i { font-style: normal; opacity: .9; }

    .tabs-container { position: sticky; top: 0; z-index: 10; margin: 16px 0; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); background: var(--bg-blur); border-top: 1px solid var(--border-primary); border-bottom: 1px solid var(--border-primary); }
    .tabs { display: flex; overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none; }
    .tabs::-webkit-scrollbar { display: none; }
    .tabs__button {
      flex-shrink: 0; cursor: pointer; color: #c7d2fe; background: transparent; border: none; border-bottom: 2px solid transparent;
      padding: 12px 16px; font-size: 15px; text-decoration: none; transition: background-color .2s, border-color .2s, color .2s;
    }
    .tabs__button:hover { background: rgba(167,139,250,.1); }
    .tabs__button[aria-selected="true"] { color: var(--text-primary); font-weight: 600; border-bottom-color: var(--color-accent); }
    .tabs__button:focus-visible { outline: 2px solid var(--color-accent); outline-offset: 2px; border-radius: 8px; }
    .tabs-tools { display:flex; gap:8px; justify-content:flex-end; padding: 8px 16px; }
    .button { display:inline-block; padding:8px 12px; border-radius:8px; border:1px solid var(--border-primary); background: rgba(15,23,42,.6); color: var(--text-primary); cursor:pointer; }
    .button:hover { background: rgba(167,139,250,.12); }
    .button[aria-pressed="true"] { outline:2px solid var(--color-accent); outline-offset:2px; }

    .tab-panels { padding-top: 16px; }
    [hidden] { display: none !important; }
    .tab-panel { animation: fadeIn .4s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .card { background: var(--bg-card); border: 1px solid var(--border-primary); border-radius: 16px; padding: 20px; }
    .card:not(:last-child) { margin-bottom: 16px; }
    .card__title { margin: 0 0 16px; font-size: 20px; color: #dbeafe; }
    .card__subtitle { margin: 4px 0 8px; font-size: 16px; color: #e9d5ff; }

    .kpi-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    @media(min-width: 900px){ .kpi-grid { grid-template-columns: repeat(4, 1fr); } }
    .kpi-card { display: flex; align-items: center; gap: 10px; border: 1px solid var(--border-primary); border-radius: 14px; padding: 14px; background: linear-gradient(180deg, rgba(2,6,23,.35), rgba(2,6,23,.2)); }
    .kpi-card__value { font-size: 20px; font-weight: 700; }
    .kpi-card__label { color: var(--text-muted); font-size: 12px; }
    .kpi-card__ring { --p:55; width: 44px; height: 44px; flex-shrink: 0; margin-left: auto; border-radius: 50%; background: conic-gradient(var(--color-primary) calc(var(--p) * 1%), rgba(56, 189, 248, .15) 0); border: 2px solid rgba(255,255,255,.06); }

    .chip { display: inline-block; padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border-primary); margin: 4px 6px 0 0; font-size: 12px; background: rgba(11,18,32,.6); }

    .legend { display: flex; flex-wrap: wrap; gap: 4px 12px; margin-top: 10px; }
    .legend__item { display: inline-flex; align-items: center; gap: 6px; font-size: 12px; }
    .legend__swatch { display: inline-block; width: 10px; height: 10px; border-radius: 3px; }
    .legend__swatch--success { background: var(--color-success); }
    .legend__swatch--primary { background: var(--color-primary); }
    .legend__swatch--accent { background: var(--color-accent); }
    .legend__swatch--warning { background: var(--color-warning); }

    .timeline { position: relative; padding-left: 12px; border-left: 2px solid; border-image: linear-gradient(to bottom, var(--color-primary), transparent) 1; }
    .timeline__item { position: relative; margin: 12px 0; padding-left: 24px; }
    .timeline__item::before { content:""; position: absolute; left: -7px; top: 6px; width: 12px; height: 12px; border-radius: 50%; background: var(--color-primary); box-shadow: 0 0 0 4px rgba(56,189,248,.2); }

    details { border: 1px solid var(--border-primary); border-radius: 12px; padding: 12px 16px; background: rgba(15,23,42,.5); }
    details + details { margin-top: 10px; }
    summary { cursor: pointer; list-style: none; }
    summary::-webkit-details-marker { display: none; }
    summary::after { content: ' ‚ñº'; font-size: 0.8em; color: var(--text-muted); float: right; }
    details[open] summary::after { content: ' ‚ñ≤'; }
    summary:focus-visible { outline:2px solid var(--color-primary); outline-offset:4px; border-radius:6px; }

    .text-muted { color: var(--text-muted); }
    .text-small { font-size: 13px; }
    .kbd { display:inline-block; padding:2px 6px; border-radius:4px; border:1px solid var(--border-primary); background: rgba(255,255,255,.06); font-size:12px; }
    .badge { display:inline-block; padding:2px 6px; border-radius:6px; background: rgba(167,139,250,.18); border:1px solid var(--border-primary); font-size:12px; }

    .helper-bar { position: fixed; left:0; right:0; bottom:0; z-index: 20; background: rgba(11,18,32,.9); backdrop-filter: blur(8px); border-top:1px solid var(--border-primary); }
    .helper-bar__inner { max-width:1080px; margin:0 auto; padding:8px 16px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .helper-bar__item { display:flex; gap:6px; align-items:center; font-size: 13px; }
    .helper-bar__controls { margin-left:auto; display:flex; gap:8px; }
    .helper-bar[aria-hidden="true"] { display:none; }

    .field { display:flex; flex-direction:column; gap:6px; margin-bottom:10px; }
    .row { display:flex; align-items:center; gap:6px; }
    .field input[type="number"], .field select { width:100%; padding:8px 10px; border-radius:8px; border:1px solid var(--border-primary); background: rgba(15,23,42,.6); color: var(--text-primary); }
    .field input[type="checkbox"] { width:auto; }
    input[aria-invalid="true"] { outline:2px solid #ef4444; outline-offset:2px; }

    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
    }
    @media (forced-colors: active) {
      .tabs__button[aria-selected="true"] { border-bottom-color: CanvasText; }
      .skip-link:focus { outline-color: CanvasText; }
    }
    @media print{
      .tabs-container, .helper-bar, #toast { display:none !important; }
      [role="tabpanel"]:not([data-print="1"]) { display:none !important; }
      body { background:none; color:#000; }
      .card { break-inside: avoid; }
    }
  </style>
</head>
<body>
  <a href="#main" class="skip-link">Î≥∏Î¨∏ÏúºÎ°ú Í±¥ÎÑàÎõ∞Í∏∞</a>
  <div class="container">
    <header class="hero">
      <h1 class="hero__title">Sub-3 ÌÜµÌï© ÌîÑÎ°úÍ∑∏Îû® v4.0</h1>
      <p class="hero__subtitle">Í∞úÏù∏Ìôî ¬∑ Í≥ºÌïôÏ†Å Í∑ºÍ±∞ ¬∑ Î¶¨Ïä§ÌÅ¨ Í¥ÄÎ¶¨ ¬∑ Î†àÏù¥Ïä§ Ïã§ÌñâÍπåÏßÄ Ìïú ÌôîÎ©¥Ïóê</p>
      <div class="hero__tags">
        <span class="hero__tag"><i>üéØ</i> Î™©Ìëú MP 4:14‚Äì4:16/km</span>
        <span class="hero__tag"><i>üìÜ</i> 52Ï£º(2ÌîºÌÅ¨ Í∞ÄÎä•)</span>
        <span class="hero__tag"><i>üß™</i> Í∑ºÍ±∞ Í∏∞Î∞ò</span>
        <span class="hero__tag"><i>üß≠</i> ÏùòÏÇ¨Í≤∞Ï†ï Ìä∏Î¶¨</span>
      </div>
    </header>

    <div class="tabs-container">
      <div class="tabs" role="tablist" aria-label="ÌõàÎ†® ÌîÑÎ°úÍ∑∏Îû® ÏÑπÏÖò" aria-orientation="horizontal">
        <button class="tabs__button" role="tab" aria-selected="true" aria-controls="panel-overview" id="tab-overview">Í∞úÏöî</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-intensity" id="tab-intensity" tabindex="-1">Í∞ïÎèÑ</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-personalize" id="tab-personalize" tabindex="-1">Í∞úÏù∏Ìôî</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-weather" id="tab-weather" tabindex="-1">ÎÇ†Ïî®</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-tests" id="tab-tests" tabindex="-1">ÌÖåÏä§Ìä∏</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-glossary" id="tab-glossary" tabindex="-1">Ïö©Ïñ¥Ïßë</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-macro" id="tab-macro" tabindex="-1">52Ï£º</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-weekly" id="tab-weekly" tabindex="-1">Ï£ºÍ∞Ñ</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-guard" id="tab-guard" tabindex="-1">ÌäúÎãù</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-special" id="tab-special" tabindex="-1">ÌäπÏàò</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-taper" id="tab-taper" tabindex="-1">ÌÖåÏù¥Ìçº</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-race" id="tab-race" tabindex="-1">Î†àÏù¥Ïä§</button>
        <button class="tabs__button" role="tab" aria-selected="false" aria-controls="panel-evidence" id="tab-evidence" tabindex="-1">Í∑ºÍ±∞</button>
      </div>
      <div class="tabs-tools">
        <button id="help-toggle" class="button" aria-pressed="false" aria-label="ÎèÑÏõÄÎßê Î™®Îìú Ï†ÑÌôò"><span aria-hidden="true">‚ùì</span> ÎèÑÏõÄÎßê</button>
      </div>
    </div>

    <main id="main" class="tab-panels">
      <section id="panel-overview" class="tab-panel is-active" role="tabpanel" aria-labelledby="tab-overview" data-print="1">
        <div class="card">
          <h2 class="card__title">ÌïúÎààÏóê Î≥¥Îäî ÌïµÏã¨ <span class="badge">Ï¶âÏãú Í∞±Ïã†</span></h2>
          <div class="kpi-grid">
            <div class="kpi-card"><div><div class="kpi-card__value"><span id="kpi-mp">4:14‚Äì4:16</span></div><div class="kpi-card__label">MP (min/km)</div></div></div>
            <div class="kpi-card"><div><div class="kpi-card__value">75‚Äì110 km</div><div class="kpi-card__label">Ï£ºÍ∞Ñ ÌîºÌÅ¨ Î≥ºÎ•®(Î†àÎ≤®Î≥Ñ)</div></div></div>
            <div class="kpi-card"><div><div class="kpi-card__value"><span id="kpi-cho">60‚Äì90(120)</span> g/h</div><div class="kpi-card__label">CHO ÏÑ≠Ï∑®(>90Î∂Ñ)</div></div></div>
            <div class="kpi-card"><div><div class="kpi-card__value">‚àí41~60%</div><div class="kpi-card__label">ÌÖåÏù¥Ìçº Î≥ºÎ•® Í∞êÎüâ</div></div><div class="kpi-card__ring" style="--p:55" aria-hidden="true"></div></div>
          </div>
          <details class="help" style="margin-top:12px">
            <summary>ÎèÑÏõÄÎßê</summary>
            <ul class="text-small text-muted" style="margin-top:8px">
              <li><strong>MP</strong>: ÎßàÎùºÌÜ§ÏóêÏÑú 1 km(ÎòêÎäî 1 mile)ÎßàÎã§ Î™©ÌëúÎ°ú ÏÇºÎäî Î∂Ñ:Ï¥à.</li>
              <li><strong>CHO g/h</strong>: ÏãúÍ∞ÑÎãπ ÌÉÑÏàòÌôîÎ¨º ÏÑ≠Ï∑®Îüâ. Ïû•Í±∞Î¶¨¬∑Í≥†Í∞ïÎèÑÏùºÏàòÎ°ù ÏÉÅÎã® Í∂åÏû•.</li>
              <li><strong>Ï¶âÏãú Í∞±Ïã†</strong>: Í∞úÏù∏Ìôî/ÎÇ†Ïî®/Îã®ÏúÑÎ•º Î∞îÍæ∏Î©¥ ÏàòÏπòÍ∞Ä Ï¶âÏãú Î∞òÏòÅÎê©ÎãàÎã§.</li>
            </ul>
          </details>
        </div>
      </section>

      <section id="panel-intensity" class="tab-panel" role="tabpanel" aria-labelledby="tab-intensity" hidden data-print="1">
        <div class="card">
          <h2 class="card__title">Í∞ïÎèÑ ÌÇ§(ÌéòÏù¥Ïä§ Í∏∞Ï§Ä)</h2>
          <div class="grid grid--3-cols">
            <div>
              <h3 class="card__subtitle">Í∏∞Î≥∏</h3>
              <span class="chip">Easy: MP +60~90s</span>
              <span class="chip">Aerobic: MP +30~60s</span>
              <span class="chip">Strides: 6‚Äì10√ó80‚Äì120m</span>
              <span class="chip" id="chip-easy">Easy(Í∞úÏù∏Ìôî): ‚Äî</span>
              <span class="chip" id="chip-aerobic">Aerobic(Í∞úÏù∏Ìôî): ‚Äî</span>
            </div>
            <div>
              <h3 class="card__subtitle">ÌíàÏßà</h3>
              <span class="chip">T: HM pace ¬±0‚Äì10s ÎòêÎäî 20‚Äì40‚Ä≤</span>
              <span class="chip">10K pace: ÏµúÍ∑º 10K Í∏∞Ï§Ä</span>
              <span class="chip">CV: 5K pace +8‚Äì12s</span>
              <span class="chip" id="chip-t">T(Í∞úÏù∏Ìôî): ‚Äî</span>
              <span class="chip" id="chip-10k">10K(Í∞úÏù∏Ìôî): ‚Äî</span>
              <span class="chip" id="chip-cv">CV(Í∞úÏù∏Ìôî): ‚Äî</span>
            </div>
            <div>
              <h3 class="card__subtitle">Î°±Îü∞</h3>
              <span class="chip">Prog LR: ÌõÑÎ∞ò 6‚Äì12 km Ï†êÏ¶ù</span>
              <span class="chip">MP Blocks: 2√ó(5‚Äì8 km @MP)</span>
              <span class="chip">ÏÉÅÌïú: 32‚Äì34 km</span>
            </div>
          </div>
          <details class="help" style="margin-top:12px">
            <summary>ÎèÑÏõÄÎßê</summary>
            <ul class="text-small text-muted" style="margin-top:8px">
              <li><strong>Easy/Aerobic</strong>: ÎåÄÌôî Í∞ÄÎä•Ìïú Í∞ïÎèÑ. MPÏóê Ï¥à/ÌÇ¨Î°ú(ÎòêÎäî Ï¥à/ÎßàÏùº)Î•º ÎçîÌï¥ ÎäêÎ¶¨Í≤å.</li>
              <li><strong>T(ÌÖúÌè¨)</strong>: Ï†ñÏÇ∞Ïó≠Ïπò Í∑ºÏ≤ò. 20‚Äì40Î∂Ñ Ïú†ÏßÄ Í∞ÄÎä•Ìïú ‚ÄòÏïΩÍ∞Ñ ÌûòÎì¶‚Äô.</li>
              <li><strong>CV</strong>: 5K ÌéòÏù¥Ïä§Î≥¥Îã§ ÏïΩÍ∞Ñ ÎäêÎ¶¨Í≤å, Ïù∏ÌÑ∞Î≤åÎ°ú ÏàòÌñâ.</li>
            </ul>
          </details>
        </div>
      </section>

      <section id="panel-personalize" class="tab-panel" role="tabpanel" aria-labelledby="tab-personalize" hidden data-print="1">
        <div class="card">
          <h2 class="card__title">ÎÇ¥ Îç∞Ïù¥ÌÑ∞ ÏûÖÎ†•</h2>
          <form id="calc-form" class="grid grid--2-cols" aria-describedby="calc-help">
            <div>
              <h3 class="card__subtitle">Ïã†Ï≤¥/ÌôòÍ≤Ω</h3>
              <label class="field">ÏÑ±Î≥Ñ
                <select id="in-sex" aria-label="ÏÑ±Î≥Ñ">
                  <option value="male">ÎÇ®ÏÑ±</option>
                  <option value="female">Ïó¨ÏÑ±</option>
                </select>
              </label>
              <label class="field">ÎÇòÏù¥
                <input id="in-age" type="number" inputmode="numeric" min="12" max="90" step="1" aria-describedby="calc-help" />
              </label>
              <label class="field">ÌÇ§ (cm)
                <input id="in-height" type="number" inputmode="decimal" min="120" max="220" step="1" aria-describedby="calc-help" />
              </label>
              <label class="field">Î™∏Î¨¥Í≤å (kg)
                <input id="in-weight" type="number" inputmode="decimal" min="35" max="120" step="0.1" aria-describedby="calc-help" />
              </label>
              <label class="field">ÎÇ†Ïî®
                <select id="in-weather" aria-label="ÎÇ†Ïî® ÏÉÅÌÉú">
                  <option value="normal">Î≥¥ÌÜµ</option>
                  <option value="heat">ÎçîÏúÑ</option>
                  <option value="cold">Ï∂îÏúÑ</option>
                  <option value="rain">ÎπÑ</option>
                  <option value="snow">Îàà¬∑Í≤∞Îπô</option>
                  <option value="hail">Ïö∞Î∞ï¬∑ÏïÖÏ≤úÌõÑ</option>
                  <option value="wind">Í∞ïÌíç</option>
                </select>
              </label>
              <label class="field">Îã®ÏúÑ
                <select id="in-units" aria-label="ÌëúÏãú Îã®ÏúÑ">
                  <option value="metric">km ¬∑ Î∂Ñ/ÌÇ¨Î°ú</option>
                  <option value="imperial">mile ¬∑ Î∂Ñ/ÎßàÏùº</option>
                </select>
              </label>
              <label class="field">Î¶¨Í≤î Î™®Îìú
                <select id="in-riegel-mode" aria-label="Î¶¨Í≤î Î™®Îìú">
                  <option value="auto">ÏûêÎèô(ÌéòÏù¥Ïä§Î≥Ñ)</option>
                  <option value="manual">ÏàòÎèô(ÏßÅÏ†ë ÏûÖÎ†•)</option>
                </select>
              </label>
              <label class="field">Î¶¨Í≤î ÏßÄÏàò (1.03‚Äì1.10)
                <input id="in-riegel" type="number" min="1.03" max="1.10" step="0.01" value="1.06" aria-describedby="calc-help" />
              </label>
              <div id="calc-help" class="text-small text-muted">Í∏∞Î°ùÏùÄ ÌïòÎÇòÎßå ÏûÖÎ†•Ìï¥ÎèÑ Í≥ÑÏÇ∞Îê©ÎãàÎã§(Ïö∞ÏÑ†: ÎßàÎùºÌÜ§ ‚Üí ÌïòÌîÑ ‚Üí 10K ‚Üí 5K). Î∂Ñ¬∑Ï¥àÎäî 0‚Äì59 Î≤îÏúÑ Í∂åÏû•. ÏÑ±Î≥ÑÏùÄ Í∂åÏû•ÏπòÍ∞Ä Ï≤¥Ï§ë(kg) Í∏∞Ï§ÄÏù¥ÎØÄÎ°ú Í∞ÑÏ†ë Î∞òÏòÅÎê©ÎãàÎã§.</div>
              <div class="row" style="gap:8px">
                <button type="button" id="btn-calc" class="button">Í≥ÑÏÇ∞</button>
                <button type="button" id="btn-reset" class="button" title="ÏûÖÎ†• Ï¥àÍ∏∞Ìôî">Ï¥àÍ∏∞Ìôî</button>
              </div>
            </div>
            <div>
              <h3 class="card__subtitle">ÏµúÍ∑º Í∏∞Î°ù</h3>
              <label class="field">5K (Î∂Ñ:Ï¥à)
                <div class="row">
                  <input id="in-5k-m" type="number" min="12" max="40" step="1" aria-label="5K Î∂Ñ" placeholder="mm ÎòêÎäî mm:ss" pattern="^\\d{1,2}(:\\d{1,2})?$" aria-describedby="calc-help" />
                  <span aria-hidden="true">:</span>
                  <input id="in-5k-s" type="number" min="0" max="59" step="1" aria-label="5K Ï¥à" aria-describedby="calc-help" />
                </div>
              </label>
              <label class="field">10K (Î∂Ñ:Ï¥à)
                <div class="row">
                  <input id="in-10k-m" type="number" min="25" max="80" step="1" aria-label="10K Î∂Ñ" placeholder="mm ÎòêÎäî mm:ss" pattern="^\\d{1,2}(:\\d{1,2})?$" aria-describedby="calc-help" />
                  <span aria-hidden="true">:</span>
                  <input id="in-10k-s" type="number" min="0" max="59" step="1" aria-label="10K Ï¥à" aria-describedby="calc-help" />
                </div>
              </label>
              <label class="field">ÌïòÌîÑ(HH:MM:SS)
                <div class="row">
                  <input id="in-hm-h" type="number" min="0" max="3" step="1" aria-label="ÌïòÌîÑ ÏãúÍ∞Ñ" placeholder="h ÎòêÎäî h:mm:ss" pattern="^\\d{1,2}(:\\d{1,2}(:\\d{1,2})?)?$" aria-describedby="calc-help" />
                  <span aria-hidden="true">:</span>
                  <input id="in-hm-m" type="number" min="0" max="59" step="1" aria-label="ÌïòÌîÑ Î∂Ñ" aria-describedby="calc-help" />
                  <span aria-hidden="true">:</span>
                  <input id="in-hm-s" type="number" min="0" max="59" step="1" aria-label="ÌïòÌîÑ Ï¥à" aria-describedby="calc-help" />
                </div>
              </label>
              <label class="field">ÎßàÎùºÌÜ§(HH:MM:SS)
                <div class="row">
                  <input id="in-m-h" type="number" min="2" max="7" step="1" aria-label="ÎßàÎùºÌÜ§ ÏãúÍ∞Ñ" placeholder="h ÎòêÎäî h:mm:ss" pattern="^\\d{1,2}(:\\d{1,2}(:\\d{1,2})?)?$" aria-describedby="calc-help" />
                  <span aria-hidden="true">:</span>
                  <input id="in-m-m" type="number" min="0" max="59" step="1" aria-label="ÎßàÎùºÌÜ§ Î∂Ñ" aria-describedby="calc-help" />
                  <span aria-hidden="true">:</span>
                  <input id="in-m-s" type="number" min="0" max="59" step="1" aria-label="ÎßàÎùºÌÜ§ Ï¥à" aria-describedby="calc-help" />
                </div>
              </label>
            </div>
          </form>
        </div>

        <div class="card">
          <h3 class="card__subtitle">Í∞úÏù∏Ìôî Í≤∞Í≥º</h3>
          <div class="grid grid--4-cols">
            <div><span class="text-small text-muted">BMI</span><div id="out-bmi" aria-live="polite">‚Äî</div></div>
            <div><span class="text-small text-muted">MP</span><div id="out-mp" aria-live="polite">‚Äî</div></div>
            <div><span class="text-small text-muted">CHO Í∂åÏû•</span><div id="out-cho" aria-live="polite">‚Äî</div></div>
            <div><span class="text-small text-muted">ÏàòÎ∂Ñ Í∂åÏû•</span><div id="out-hydr" aria-live="polite">‚Äî</div></div>
            <div><span class="text-small text-muted">Na Í∂åÏû•</span><div id="out-na" aria-live="polite">‚Äî</div></div>
          </div>
          <details class="help" style="margin-top:12px">
            <summary>ÎèÑÏõÄÎßê</summary>
            <ul class="text-small text-muted" style="margin-top:8px">
              <li><strong>Í≥ÑÏÇ∞Ïãù</strong>: ÎßàÎùºÌÜ§ ÏòàÏ∏°ÏãúÍ∞Ñ = ÏûÖÎ†•Í∏∞Î°ù √ó (42.195 / ÏûÖÎ†•Í±∞Î¶¨)<sup>exp</sup> ‚Üí 1km ÌéòÏù¥Ïä§. expÎäî ÏûêÎèô/ÏàòÎèô ÏÑ†ÌÉù.</li>
              <li><strong>CHO</strong>: 0.8‚Äì1.0 g √ó Ï≤¥Ï§ë(kg)/h, ÏµúÏÜå 60 g/h, ÏµúÎåÄ 120 g/h.</li>
              <li><strong>ÏàòÎ∂Ñ</strong>: Î≥¥ÌÜµ 6‚Äì10, ÎçîÏúÑ 8‚Äì12 mL √ó Ï≤¥Ï§ë(kg)/h ‚Üí L/hÎ°ú ÌëúÍ∏∞(ÏÉÅÌïú 1.2 L/h).</li>
              <li><strong>Na</strong>: Î≥¥ÌÜµ 300‚Äì600 mg/h, ÎçîÏúÑ 600‚Äì1000 mg/h.</li>
              <li><strong>ÎßàÏä§ÌÑ∞Ïä§(‚â•40ÏÑ∏)</strong>: ÏÉÅÎã® Î≥¥Ïàò(+3~5 s/km) ÏûêÎèô Ï†ÅÏö©.</li>
            </ul>
          </details>
        </div>
      </section>

      <section id="panel-weather" class="tab-panel" role="tabpanel" aria-labelledby="tab-weather" hidden data-print="1">
        <div class="card">
          <h2 class="card__title">ÎÇ†Ïî®Î≥Ñ ÎåÄÏùë Í∞ÄÏù¥Îìú</h2>
          <div class="grid grid--3-cols">
            <div>
              <h3 class="card__subtitle">ÌéòÏù¥Ïä§ Î≥¥Ï†ï(+s/km)</h3>
              <div class="text-small">Easy <strong id="wx-easy">+0</strong>, Aerobic <strong id="wx-aer">+0</strong>, T <strong id="wx-t">+0</strong>, CV <strong id="wx-cv">+0</strong></div>
            </div>
            <div>
              <h3 class="card__subtitle">Î°±Îü∞ Î≥¥Ï†ï</h3>
              <div class="text-small"><strong id="wx-lr">0%</strong></div>
            </div>
            <div>
              <h3 class="card__subtitle">Ïã§ÎÇ¥ Ï†ÑÌôò</h3>
              <div class="text-small"><strong id="wx-indoor">ÏïÑÎãàÏò§</strong></div>
            </div>
          </div>
          <div style="margin-top:12px" class="text-small">
            ÏàòÎ∂Ñ: <strong id="wx-hydr">‚Äî</strong> ¬∑ Na: <strong id="wx-na">‚Äî</strong>
          </div>
          <ul id="weather-tips" style="margin-top:12px"></ul>
          <div class="text-small" style="margin-top:8px">Ïò§Îäò Í∂åÏû• ÏÑ∏ÏÖò: <strong id="wx-session">Í≥ÑÌöçÎåÄÎ°ú</strong></div>
        </div>
      </section>

      <section id="panel-tests" class="tab-panel" role="tabpanel" aria-labelledby="tab-tests" hidden data-print="1">
        <div class="card">
          <h2 class="card__title">ÌÖåÏä§Ìä∏(ÏûÖÎ†• ÏµúÏã†Ìôî ÏùºÏ†ï)</h2>
          <ul>
            <li>W8: 5K ÌÉÄÏûÑ Ìä∏ÎùºÏù¥Ïñº</li>
            <li>W12: 10K Î†àÏù¥Ïä§/ÌÖåÏä§Ìä∏</li>
            <li>W18¬±2: ÌïòÌîÑÎßàÎùºÌÜ§ B-Î†àÏù¥Ïä§</li>
            <li>W28: (ÏòµÏÖò) 5K Ïû¨Ï∏°Ï†ï</li>
            <li>W30: (ÏòµÏÖò) 8‚Äì10K ÌÖúÌè¨/Î†àÏù¥Ïä§</li>
            <li>W32: ÎßàÎùºÌÜ§ A Î†àÏù¥Ïä§</li>
          </ul>
          <p class="text-small text-muted">ÌÖåÏä§Ìä∏ ÌõÑ <a href="#panel-personalize">Í∞úÏù∏Ìôî</a> Í∏∞Î°ùÏùÑ Í∞±Ïã†ÌïòÎ©¥ Î™®Îì† ÏàòÏπòÍ∞Ä Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏Îê©ÎãàÎã§.</p>
        </div>
      </section>

      <section id="panel-glossary" class="tab-panel" role="tabpanel" aria-labelledby="tab-glossary" hidden>
        <div class="card">
          <h2 class="card__title">Ïö©Ïñ¥Ïßë(ÏâΩÍ≤å Î≥¥Í∏∞)</h2>
          <dl class="text-small">
            <dt><strong>MP</strong></dt><dd>ÎßàÎùºÌÜ§ Î™©Ìëú ÌéòÏù¥Ïä§(Î∂Ñ:Ï¥à/ÌÇ¨Î°ú ÎòêÎäî Î∂Ñ:Ï¥à/ÎßàÏùº).</dd>
            <dt><strong>Easy</strong></dt><dd>Ìé∏ÏïàÌïú Îã¨Î¶¨Í∏∞. MP +60~90Ï¥à.</dd>
            <dt><strong>Aerobic</strong></dt><dd>Ï°∞Í∏à Îçî Îπ†Î•∏ Í∏∞Î≥∏ Îã¨Î¶¨Í∏∞. MP +30~60Ï¥à.</dd>
            <dt><strong>T(ÌÖúÌè¨)</strong></dt><dd>Ï†ñÏÇ∞Ïó≠Ïπò Í∑ºÏ≤ò. 20‚Äì40Î∂Ñ ÏßÄÏÜç Í∞ÄÎä•Ìïú ‚ÄòÏïΩÍ∞Ñ ÌûòÎì¶‚Äô.</dd>
            <dt><strong>CV</strong></dt><dd>ÏûÑÍ≥ÑÏÜçÎèÑ. 5K ÌéòÏù¥Ïä§Î≥¥Îã§ ÏïΩÍ∞Ñ ÎäêÎ¶¨Í≤å Ïù∏ÌÑ∞Î≤å.</dd>
            <dt><strong>Strides</strong></dt><dd>80‚Äì120m ÏßßÍ≥† Îπ†Î•¥Í≤å 6‚Äì10Ìöå, ÏûêÏÑ∏/Î¶¨Îì¨ Í∞úÏÑ†.</dd>
            <dt><strong>CHO g/h</strong></dt><dd>ÏãúÍ∞ÑÎãπ ÌÉÑÏàòÌôîÎ¨º ÏÑ≠Ï∑®Îüâ.</dd>
            <dt><strong>ÏàòÎ∂Ñ L/h</strong></dt><dd>ÏãúÍ∞ÑÎãπ Î¨º ÏÑ≠Ï∑®Îüâ. ÎÇ†Ïî®¬∑Ï≤¥Ï§ë Ï°∞Ï†à.</dd>
            <dt><strong>Na mg/h</strong></dt><dd>ÏãúÍ∞ÑÎãπ ÎÇòÌä∏Î•® ÏÑ≠Ï∑®Îüâ.</dd>
            <dt><strong>Riegel</strong></dt><dd>Îã§Î•∏ Í±∞Î¶¨ Í∏∞Î°ùÏúºÎ°ú ÎßàÎùºÌÜ§ ÏãúÍ∞Ñ ÏòàÏ∏° ÏßÄÏàò.</dd>
            <dt><strong>LR</strong></dt><dd>Î°±Îü∞(Long Run). Ï£ºÍ∞Ñ ÏµúÏû• Í±∞Î¶¨.</dd>
          </dl>
        </div>
      </section>

      <section id="panel-macro" class="tab-panel" role="tabpanel" aria-labelledby="tab-macro" hidden>
        <div class="card">
          <h2 class="card__title">52Ï£º Î°úÎìúÎßµ</h2>
          <div class="timeline">
            <div class="timeline__item"><strong>ÌîÑÎ†ô W1‚Äì4</strong> ¬∑ ÏäµÍ¥Ä¬∑ÌöåÎ≥µ ¬∑ Easy/Ïñ∏Îçï Ïä§ÌîÑÎ¶∞Ìä∏</div>
            <div class="timeline__item"><strong>Î≤†Ïù¥Ïä§1 W5‚Äì12</strong> ¬∑ Ïú†ÏÇ∞ÏÜå ÌÜ†ÎåÄ ¬∑ T(ÏßßÍ≤å)/Ïñ∏Îçï ¬∑ LR 24‚Äì28 km</div>
            <div class="timeline__item"><strong>Î≤†Ïù¥Ïä§2 W13‚Äì20</strong> ¬∑ LT/10K Í∞ïÌôî ¬∑ HM B-Î†àÏù¥Ïä§</div>
            <div class="timeline__item"><strong>Ïä§ÌéòÏãúÌîΩ1 W21‚Äì28</strong> ¬∑ MP Î∏îÎ°ù/Prog LR ¬∑ Ïó∞Î£å Ï†ÑÎûµ Î¶¨ÌóàÏÑ§</div>
            <div class="timeline__item"><strong>ÌîºÌÅ¨¬∑ÌÖåÏù¥Ìçº W29‚Äì32</strong> ¬∑ LR 32‚Äì34 km 1‚Äì2Ìöå ÌõÑ Ï†êÍ∞ê ¬∑ Î†àÏù¥Ïä§</div>
            <div class="timeline__item"><strong>Î¶¨Ïª§Î≤ÑÎ¶¨ W33‚Äì36</strong> ¬∑ Íµ¨Ï°∞Ï†Å ÌöåÎ≥µ ¬∑ Easy/ÌÅ¨Î°úÏä§</div>
            <div class="timeline__item"><strong>Ïä§ÌéòÏãúÌîΩ2 W37‚Äì46</strong> ¬∑ Í∞ÄÏùÑ A' ÎòêÎäî B Î†àÏù¥Ïä§ Ï§ÄÎπÑ</div>
            <div class="timeline__item"><strong>ÌÖåÏù¥ÌçºB W47‚Äì50</strong> ¬∑ Î≥ºÎ•® ‚àí30~50%</div>
            <div class="timeline__item"><strong>Ïò§ÌîÑ¬∑Î¶¨ÏÖã W51‚Äì52</strong> ¬∑ Í±∑Í∏∞/ÏöîÍ∞Ä/Í∞ÄÎ≤ºÏö¥ Ï°∞ÍπÖ</div>
          </div>
          <p class="text-small text-muted" style="margin-top:12px">3‚Äì4Ï£ºÎßàÎã§ Ïª∑Î∞±(‚àí20~35%). HM ÏïΩ W18¬±2, ÎßàÎùºÌÜ§ A W32, ÏÑ†ÌÉù B W50.</p>
        </div>
      </section>

      <section id="panel-weekly" class="tab-panel" role="tabpanel" aria-labelledby="tab-weekly" hidden>
        <div class="card">
          <h2 class="card__title">Ï£ºÍ∞Ñ ÌÖúÌîåÎ¶ø</h2>
          <div class="grid grid--2-cols">
            <div><h3 class="card__subtitle">Î≤†Ïù¥Ïä§ Ï£º</h3><ul><li>Ïõî: Easy 10‚Äì14 + Strides</li><li>Ìôî: Ïñ∏Îçï 10√ó60" ÎòêÎäî CV 5√ó5'(2')</li><li>Ïàò: Aerobic 12‚Äì16</li><li>Î™©: T 2√ó5 km(2‚Äì3') ÎòêÎäî T 30‚Äì40'</li><li>Í∏à: Easy 8‚Äì12 + S&C 25‚Äô</li><li>ÌÜ†: Easy 10‚Äì14(ÏûîÎîî/Ìä∏Î†àÏùº)</li><li>Ïùº: LR 24‚Äì28(ÌõÑÎ∞ò 4‚Äì6 km Ï†êÏ¶ù) <span class="badge" id="lr-advice-base">0%</span></li></ul></div>
            <div><h3 class="card__subtitle">Ïä§ÌéòÏãúÌîΩ Ï£º</h3><ul><li>Ïõî: ÌöåÎ≥µ 8‚Äì12 + Î™®ÎπåÎ¶¨Ìã∞</li><li>Ìôî: 10√ó1 km @10K(60‚Äì75")</li><li>Ïàò: Aerobic 14‚Äì18 + Strides</li><li>Î™©: MP Î∏îÎ°ù 2√ó(6‚Äì8 km) / 2‚Äì3 km Ï°∞ÍπÖ</li><li>Í∏à: Easy 8‚Äì12 + S&C 20‚Äô</li><li>ÌÜ†: Easy 10‚Äì12</li><li>Ïùº: LR 28‚Äì32(ÌõÑÎ∞ò 8‚Äì12 km @MP~MP+10s) <span class="badge" id="lr-advice-spec">0%</span></li></ul></div>
          </div>
        </div>
      </section>

      <section id="panel-guard" class="tab-panel" role="tabpanel" aria-labelledby="tab-guard" hidden>
        <div class="card">
          <h2 class="card__title">ÍµêÏ≤¥ Îß§Ìä∏Î¶≠Ïä§(Ïò§Î≤ÑÎ¶¨Ïπò Î∞©ÏßÄ)</h2>
          <div class="grid grid--2-cols">
            <div><h3 class="card__subtitle">Ìä∏Î¶¨Í±∞</h3><ul><li>RHR Î≤†Ïù¥Ïä§+‚â•5 bpm</li><li>HRV Status Low/Unbalanced ÎòêÎäî 7ÏùºÌèâÍ∑† ‚â§ 28Ïùº Ï§ëÏïôÍ∞í‚àí10%</li><li>RPE ‚â• 7</li></ul></div>
            <div><h3 class="card__subtitle">Ï°∞Ïπò</h3><ul><li>ÌïòÎ£® 2Í∞ú Ïù¥ÏÉÅ Ïã†Ìò∏Í∞Ä 2Ïùº Ïó∞ÏÜç ‚Üí Í∞ÄÏû• ÎÜíÏùÄ ÎÇúÏù¥ÎèÑ ÌíàÏßà 1Í∞ú ÏÇ≠Ï†ú</li><li>Î°±Îü∞ Ïú†ÏßÄ, Í∏∏Ïù¥ ‚àí10~20%, Í∞ïÎèÑ ÏôÑÌôî</li><li>ÎçîÏúÑ/Í≥†ÎèÑ Ï≤´ 7‚Äì10Ïùº: Î™®Îì† Í∞ïÎèÑ ‚àí1Îã®Í≥Ñ</li></ul></div>
          </div>
        </div>
      </section>

      <section id="panel-special" class="tab-panel" role="tabpanel" aria-labelledby="tab-special" hidden>
        <div class="card">
          <h2 class="card__title">ÌäπÏàò Íµ∞: Ïó¨ÏÑ±¬∑ÎßàÏä§ÌÑ∞Ïä§¬∑Î∂ÄÏÉÅ Î≥µÍ∑Ä</h2>
          <div class="grid grid--3-cols">
            <div><h3 class="card__subtitle">Ïó¨ÏÑ±</h3><ul><li>Ìô©Ï≤¥Í∏∞: T/VO2 10‚Äì15 s/km ÏôÑÌôî ÎòêÎäî Î≥ºÎ•® ‚àí10~15%</li><li>ÏàòÎ∂Ñ¬∑Na ÏÉÅÌñ•</li></ul></div>
            <div><h3 class="card__subtitle">ÎßàÏä§ÌÑ∞Ïä§(40ÏÑ∏‚Üë)</h3><ul><li>ÌíàÏßà Í∞Ñ ÌöåÎ≥µ 48‚Äì72 h</li><li>Ï†êÏßÑÏ†Å ÌîåÎùºÏù¥Ïò§Î©îÌä∏Î¶≠Ïä§</li><li>2:1 Ï†ÅÏû¨:Ïª∑Î∞± ÌóàÏö©</li></ul></div>
            <div><h3 class="card__subtitle">Î∂ÄÏÉÅ Î≥µÍ∑Ä</h3><ol class="text-small"><li>1'/1'√ó10‚Äì15 ‚Üí 3'/2'√ó6‚Äì8 ‚Üí 10‚Äì30' Ïó∞ÏÜç Easy</li><li>ÌÜµÏ¶ù 2/10‚Üë ÎòêÎäî Îã§ÏùåÎÇ† ÏûîÏ°¥ Ïãú Îã®Í≥Ñ ‚àí1</li><li>ÌíàÏßà¬∑Ïñ∏Îçï Í∏àÏßÄ</li></ol></div>
          </div>
        </div>
      </section>

      <section id="panel-taper" class="tab-panel" role="tabpanel" aria-labelledby="tab-taper" hidden>
        <div class="card">
          <h2 class="card__title">ÌÖåÏù¥Ìçº(2‚Äì3Ï£º)</h2>
          <ul><li>Ï£ºÍ∞Ñ Î≥ºÎ•® ‚àí41~60% Ï†êÍ∞ê, Í∞ïÎèÑ¬∑ÎπàÎèÑ Ïú†ÏßÄ</li><li>ÎßàÏßÄÎßâ 7‚Äì10Ïùº: MP Ï¥âÍ∞ê 6‚Äì10 km 1Ìöå, 400 m√ó6 Í∞ÄÎ≥çÍ≤å</li></ul>
        </div>
      </section>

      <section id="panel-race" class="tab-panel" role="tabpanel" aria-labelledby="tab-race" hidden>
        <div class="card">
          <h2 class="card__title">Î†àÏù¥Ïä§ Ïã§Ìñâ(ÏÑúÎ∏å3)</h2>
          <div class="grid grid--3-cols">
            <div><h3 class="card__subtitle">ÌéòÏù¥Ïã±</h3><ul><li>0‚Äì5 km: MP+5‚Äì8s</li><li>5‚Äì35 km: MP ÏïàÏ†ï</li><li>35‚Äì42.2 km: ÏÉÅÌô©Î≥Ñ ‚àí5~+10s</li></ul></div>
            <div><h3 class="card__subtitle">Í∏âÏàò/ÏòÅÏñë</h3><ul><li>Ï†§: 30‚Äì35Î∂ÑÎßàÎã§ 1Í∞ú(20‚Äì30 g)</li><li>CHO 60‚Äì90(Ï†ÅÏùë Ïãú 90‚Äì110) g/h</li><li>ÏàòÎ∂Ñ 0.4‚Äì0.8 L/h ¬∑ Na 300‚Äì600 mg/h(ÎçîÏúÑ 800‚Äì1000)</li></ul></div>
            <div><h3 class="card__subtitle">Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏</h3><ul><li>Î†àÏù¥Ïä§Ìôî 2‚Äì3Ìöå ÏÇ¨Ï†Ñ Í≤ÄÏ¶ù</li><li>Ï†§/ÏùåÎ£å Î∏åÎûúÎìú Î¶¨ÌóàÏÑ§ ÏôÑÎ£å</li><li>ÎÇ†Ïî® ÌîåÎûú A/B/C Ï§ÄÎπÑ</li></ul></div>
          </div>
        </div>
      </section>

      <section id="panel-evidence" class="tab-panel" role="tabpanel" aria-labelledby="tab-evidence" hidden>
        <div class="card">
          <h2 class="card__title">Í∑ºÍ±∞</h2>
          <ol class="cols-2 text-small">
            <li>Thomas DT, Erdman KA, Burke LM. Nutrition and Athletic Performance. J Acad Nutr Diet. 2016;116(3):501‚Äì528; Med Sci Sports Exerc. 48(3):543‚Äì568.</li>
            <li>ACSM Position Stand. Exercise and Fluid Replacement. Med Sci Sports Exerc. 2007;39(2):377‚Äì390.</li>
            <li>Jeukendrup AE. Multiple transportable carbohydrates and endurance performance. Sports Med. 2010‚Äì2014.</li>
            <li>Bosquet L, et al. Effects of tapering on performance: meta-analysis. Med Sci Sports Exerc. 2007;39(8):1358‚Äì1365.</li>
            <li>Seiler S. Training intensity distribution and endurance performance. 2009‚Äì2010.</li>
            <li>St√∂ggl T, Sperlich B. Polarized vs. threshold training. Front Physiol. 2014;5:33.</li>
            <li>P√©riard JD, et al. Heat acclimation and endurance performance. Sports Med. 2015‚Äì2021.</li>
            <li>Quantitative Analysis of 92 12-Week Sub-elite Marathon Training Plans. PMC.</li>
            <li>The Training Characteristics of World-Class Distance Runners.</li>
            <li>Factors Influencing Running Performance During a Marathon: Breaking the 2-h Barrier. PMC.</li>
            <li>Genes and Elite Marathon Running Performance: Systematic Review. PMC.</li>
            <li>Post-analysis methods for lactate threshold in runners. PMC.</li>
            <li>Physiological and training characteristics of recreational marathon runners. PMC.</li>
            <li>Strength training and running economy: systematic reviews/meta-analyses. PMC.</li>
            <li>Advanced footwear technology and elite marathon speed.</li>
            <li>Training periodization/intensity distribution in elite distance runners. IJSPP 2022;17(6):820.</li>
            <li>Training intensity distribution among endurance athletes. PMC.</li>
            <li>Editorial: training intensity, volume, recovery distribution. PMC.</li>
            <li>Training intensity distribution of marathon runners across performance levels. PubMed.</li>
            <li>Training for a (half-)marathon: volume/longest run vs performance/injury. PMC.</li>
            <li>Determinants of marathon performance: meta-analysis with meta-regression. PubMed.</li>
            <li>Lactate-guided intervals within high-volume low-intensity approach. PMC.</li>
            <li>HIIT effects in recreational endurance runners: systematic review. PMC.</li>
            <li>Running-specific strength/endurance/concurrent training effects. PMC.</li>
            <li>Nutrition concepts for elite distance runners. PMC.</li>
            <li>Marathon nutrition: fuel for training and racing. PubMed.</li>
            <li>Post-exercise recovery nutrition frameworks/reviews. PMC.</li>
            <li>Carbohydrate periodization & glycogen threshold. PMC.</li>
            <li>Sleep-low train-low intervention in women. EJ-Sport.</li>
            <li>Nutrition/training periodization case study. PubMed.</li>
            <li>Glycogen loading case report (racewalker). PMC.</li>
            <li>Ultra runners‚Äô dietary observations (24h). PMC.</li>
            <li>Marathon runners‚Äô intake/timing vs finish time. PMC.</li>
            <li>120 g/h carbohydrates and muscle damage in mountain marathon. PMC.</li>
            <li>Nutrition and muscle recovery; performance enhancement. PMC.</li>
            <li>Recovery strategies after training/competition: umbrella review. PMC.</li>
            <li>Mental toughness/resilience/mental training effects. PMC/Frontiers.</li>
            <li>Technological advances in elite marathon performance. J Appl Physiol.</li>
            <li>World-class 800/1500-m training science/practice. PMC.</li>
            <li>Recommender systems & ML for marathon runners. PMC.</li>
          </ol>
          <p class="text-small text-muted" style="margin-top:12px;">Î≥∏ UIÎäî Í∞ÄÏù¥ÎìúÏù¥Î©∞, Í∞úÏù∏ ÏùòÎ£å¬∑ÏÉùÌôú Ï†úÏïΩÏóê Îî∞Î•∏ Ï°∞Ï†ïÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.</p>
        </div>
      </section>
    </main>
  </div>

  <div class="helper-bar" id="quickbar" role="status" aria-live="polite">
    <div class="helper-bar__inner">
      <div class="helper-bar__item"><strong>MP</strong> <span id="q-mp">‚Äî</span></div>
      <div class="helper-bar__item"><strong>Easy</strong> <span id="q-easy">‚Äî</span></div>
      <div class="helper-bar__item"><strong>T</strong> <span id="q-t">‚Äî</span></div>
      <div class="helper-bar__item"><strong>CV</strong> <span id="q-cv">‚Äî</span></div>
      <div class="helper-bar__item"><strong>CHO</strong> <span id="q-cho">‚Äî</span></div>
      <div class="helper-bar__item"><strong>ÏàòÎ∂Ñ</strong> <span id="q-hydr">‚Äî</span></div>
      <div class="helper-bar__item"><strong>Na</strong> <span id="q-na">‚Äî</span></div>
      <div class="helper-bar__item"><strong>ÏÜçÎèÑ</strong> <span id="q-speed">‚Äî</span></div>
      <div class="helper-bar__item"><strong>ÏÑ∏ÏÖò</strong> <span id="q-session">‚Äî</span></div>
      <div class="helper-bar__item"><span class="badge" id="q-weather">Î≥¥ÌÜµ</span> <span class="badge" id="q-masters" aria-hidden="true" style="display:none">ÎßàÏä§ÌÑ∞Ïä§</span></div>
      <div class="helper-bar__controls">
        <button class="button" id="btn-share" title="ÌòÑÏû¨ ÏÑ§Ï†ï Í≥µÏú†">Í≥µÏú†</button>
        <button class="button" id="btn-copy" title="ÏöîÏïΩ Î≥µÏÇ¨">üìã Î≥µÏÇ¨</button>
        <button class="button" id="btn-hidebar" aria-expanded="true" title="ÌïòÎã® Î∞î Ïà®Í∏∞Í∏∞/Î≥¥Ïù¥Í∏∞">
          <span id="hidebar-ico" aria-hidden="true">üûÇ</span> <span id="hidebar-label">Ï†ëÍ∏∞</span>
        </button>
      </div>
    </div>
  </div>

  <div id="toast" aria-live="polite" class="text-small" style="position:fixed;right:12px;bottom:56px;z-index:30;max-width:60ch;"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tablist = document.querySelector('[role="tablist"]');
      if (!tablist) return;

      const tabs = Array.from(tablist.querySelectorAll('[role="tab"]'));
      const panels = Array.from(document.querySelectorAll('[role="tabpanel"]'));
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function safeScrollIntoView(el){
        try { el.scrollIntoView({ block: 'nearest', inline: 'nearest', behavior: prefersReducedMotion ? 'auto' : 'smooth' }); } catch(e){}
      }
      function togglePanels(targetId){
        panels.forEach(p => { const on = p.id === targetId; if (on) p.removeAttribute('hidden'); else p.setAttribute('hidden',''); });
      }
      function activate(tab, userInitiated=false){
        if (!tab) return;
        tabs.forEach(t => { t.setAttribute('aria-selected', String(t===tab)); t.setAttribute('tabindex', t===tab ? '0' : '-1'); });
        const targetId = tab.getAttribute('aria-controls');
        togglePanels(targetId);
        if (targetId) {
          const url = `#${targetId}`;
          if (userInitiated) history.pushState(null, '', url);
          else history.replaceState(null, '', url);
        }
        tab.focus();
        safeScrollIntoView(tab);
      }

      const initTabs = () => {
        const hashId = location.hash?.slice(1);
        const byHash = hashId ? tabs.find(t => t.getAttribute('aria-controls') === hashId) : null;
        activate(byHash || tabs[0], false);
      };

      tablist.addEventListener('click', (e) => {
        const clickedTab = e.target.closest('button[role="tab"]');
        if (clickedTab) activate(clickedTab, true);
      });
      tablist.addEventListener('keydown', (e) => {
        const current = e.target.closest('button[role="tab"]');
        if (!current) return;
        const i = tabs.indexOf(current);
        let next = null;
        if (e.key === 'ArrowRight') next = tabs[(i + 1) % tabs.length];
        else if (e.key === 'ArrowLeft') next = tabs[(i - 1 + tabs.length) % tabs.length];
        else if (e.key === 'Home') next = tabs[0];
        else if (e.key === 'End') next = tabs[tabs.length - 1];
        else return;
        e.preventDefault();
        activate(next, true);
      });
      window.addEventListener('hashchange', () => {
        const id = location.hash?.slice(1);
        const match = id ? tabs.find(t => t.getAttribute('aria-controls') === id) : null;
        if (match) activate(match, false);
      });
      initTabs();

      const WEATHER_RULES = {
        normal: { mlPerKg:[6,10], na:[300,600], paceAdj:{easy:0,aer:0,t:0,cv:0}, lrPct:[0,0], indoor:'ÏïÑÎãàÏò§', tips:['ÏùºÎ∞ò Ï°∞Í±¥. Í≥ÑÌöçÎåÄÎ°ú ÏßÑÌñâ.'] },
        heat:   { mlPerKg:[8,12], na:[600,1000], paceAdj:{easy:10,aer:8,t:12,cv:8}, lrPct:[-20,-10], indoor:'Ï°∞Í±¥Î∂Ä', tips:['ÏÑúÎäòÌïú ÏãúÍ∞ÑÎåÄÎ°ú Ïù¥Îèô','Í∑∏Îäò/Í∏âÏàò ÌôïÎ≥¥','Î∞òÎ≥µÏàò 10‚Äì20% Ï∂ïÏÜå','Ïó¥Ï¶ùÏÉÅ Ïãú Ï§ëÎã®'] },
        cold:   { mlPerKg:[4,8],  na:[300,500], paceAdj:{easy:4,aer:4,t:6,cv:4},   lrPct:[-10,0],  indoor:'Ï°∞Í±¥Î∂Ä', tips:['ÏõåÎ∞çÏóÖ Ïó∞Ïû•','Í≤πÍ≤πÏù¥ Ï∞©Ïö©','ÎπôÌåê Ïãú Í≥†Í∞ïÎèÑ Î≥¥Î•ò'] },
        rain:   { mlPerKg:[6,10], na:[300,600], paceAdj:{easy:5,aer:5,t:8,cv:5},   lrPct:[-10,0],  indoor:'Ï°∞Í±¥Î∂Ä', tips:['ÎØ∏ÎÅÑÎüº Ï£ºÏùò','Ïù∏ÌÑ∞Î≤åÏùÄ Ìä∏Î†àÎìúÎ∞Ä Í≥†Î†§','Ï†ÄÏ≤¥Ïò® ÏòàÎ∞©'] },
        snow:   { mlPerKg:[6,10], na:[300,600], paceAdj:{easy:12,aer:12,t:20,cv:15},lrPct:[-30,-10], indoor:'Í∂åÏû•', tips:['Ïã§ÎÇ¥ ÎåÄÏ≤¥ Í∂åÏû•','Î°±Îü∞ 10‚Äì30% Îã®Ï∂ï','Îã§Ïö¥Ìûê/VO2 Í∏àÏßÄ'] },
        hail:   { mlPerKg:[6,10], na:[300,600], paceAdj:{easy:15,aer:15,t:25,cv:20},lrPct:[-30,-10], indoor:'ÌïÑÏàò', tips:['Ïã§ÎÇ¥Î°ú Ï†ÑÌôò','ÏïºÏô∏ ÌõàÎ†® Ïó∞Í∏∞'] },
        wind:   { mlPerKg:[6,10], na:[300,600], paceAdj:{easy:4,aer:4,t:6,cv:6},   lrPct:[-10,0],  indoor:'Ï°∞Í±¥Î∂Ä', tips:['Î£®ÌîÑ ÏΩîÏä§ ÏÇ¨Ïö©','ÎßûÎ∞îÎûå Íµ¨Í∞Ñ RPE Í∏∞Ï§Ä','Ïã§ÎÇ¥ ÎåÄÏ≤¥'] }
      };

      const $ = (id) => document.getElementById(id);
      const els = {
        sex: $('in-sex'), age: $('in-age'),
        height: $('in-height'), weight: $('in-weight'), weather: $('in-weather'),
        units: $('in-units'),
        rMode: $('in-riegel-mode'), rExp: $('in-riegel'),
        k5m: $('in-5k-m'), k5s: $('in-5k-s'),
        k10m: $('in-10k-m'), k10s: $('in-10k-s'),
        hmH: $('in-hm-h'), hmM: $('in-hm-m'), hmS: $('in-hm-s'),
        mH: $('in-m-h'), mM: $('in-m-m'), mS: $('in-m-s'),
        outBMI: $('out-bmi'), outMP: $('out-mp'),
        outCHO: $('out-cho'), outHydr: $('out-hydr'), outNa: $('out-na'),
        kpiMP: $('kpi-mp'), kpiCHO: $('kpi-cho'),
        chipEasy: $('chip-easy'), chipAer: $('chip-aerobic'),
        chipT: $('chip-t'), chip10K: $('chip-10k'), chipCV: $('chip-cv'),
        wx: { easy:$('wx-easy'), aer:$('wx-aer'), t:$('wx-t'), cv:$('wx-cv'), lr:$('wx-lr'), indoor:$('wx-indoor'), tips:$('weather-tips'), hydr:$('wx-hydr'), na:$('wx-na'), session:$('wx-session') },
        quick: { mp:$('q-mp'), easy:$('q-easy'), t:$('q-t'), cv:$('q-cv'), cho:$('q-cho'), hydr:$('q-hydr'), na:$('q-na'), speed:$('q-speed'), session:$('q-session'), weather:$('q-weather'), masters:$('q-masters') },
        kbar: $('quickbar'), btnCopy: $('btn-copy'), btnHideBar: $('btn-hidebar'), btnShare: $('btn-share'),
        btnCalc: $('btn-calc'), btnReset: $('btn-reset'), helpToggle: $('help-toggle')
      };

      const clamp = (v, lo, hi) => Math.min(Math.max(v, lo), hi);
      const KM_PER_MILE = 1.609344;
      const getUnits = () => (els.units?.value || 'metric');
      const unitLabel = () => getUnits()==='imperial' ? '/mile' : '/km';
      const secToPaceStr = (sec) => {
        if (!isFinite(sec) || sec <= 0) return '‚Äî';
        const s = Math.round(getUnits()==='imperial' ? sec * KM_PER_MILE : sec);
        const m = Math.floor(s / 60);
        const ss = String(s % 60).padStart(2, '0');
        return `${m}:${ss}${unitLabel()}`;
      };
      const setText = (el, next) => { if (!el) return; if (el.textContent !== next) el.textContent = next; };
      const readNumber = (el) => { const v = parseFloat(el?.value); return Number.isFinite(v) ? v : 0; };
      const normalizeMS = (min, sec) => {
        let m = Number.isFinite(min) ? Math.max(0, Math.floor(min)) : 0;
        let s = Number.isFinite(sec) ? Math.floor(sec) : 0;
        if (s < 0) s = 0;
        if (s >= 60) { m += Math.floor(s/60); s = s % 60; }
        return m*60 + s;
      };
      const wirePasteSplit = (minEl, secEl, isHM=false, hEl=null, mEl=null, sEl=null) => {
        const handler = (e)=>{
          const raw = e.target.value || '';
          const parts = String(raw).trim().split(':').map(n=>parseInt(n,10)).filter(n=>Number.isFinite(n));
          if (!parts.length) return;
          if (!isHM && parts.length===2){ minEl.value=parts[0]; secEl.value=parts[1]; e.target.value=parts[0]; e.preventDefault?.(); }
          if (isHM){
            if (parts.length===3){ hEl.value=parts[0]; mEl.value=parts[1]; sEl.value=parts[2]; e.preventDefault?.(); }
            if (parts.length===2){ hEl.value=0; mEl.value=parts[0]; sEl.value=parts[1]; e.preventDefault?.(); }
          }
        };
        minEl?.addEventListener('change', handler);
        minEl?.addEventListener('paste', handler);
      };
      wirePasteSplit(els.k5m, els.k5s);
      wirePasteSplit(els.k10m, els.k10s);
      wirePasteSplit(els.hmH, null, true, els.hmH, els.hmM, els.hmS);
      wirePasteSplit(els.mH,  null, true, els.mH,  els.mM,  els.mS);

      const STATE_KEY = 'sub3_v4_state';
      let saveT = null;
      function saveStateDebounced(payload){
        if (saveT) clearTimeout(saveT);
        saveT = setTimeout(() => { try { localStorage.setItem(STATE_KEY, JSON.stringify(payload)); } catch(e){} }, 300);
      }
      function saveState(){
        const data = {
          sex: els.sex?.value, age: els.age?.value, height: els.height?.value, weight: els.weight?.value, weather: els.weather?.value, units: els.units?.value,
          rMode: els.rMode?.value, rExp: els.rExp?.value,
          k5m: els.k5m?.value, k5s: els.k5s?.value, k10m: els.k10m?.value, k10s: els.k10s?.value,
          hmH: els.hmH?.value, hmM: els.hmM?.value, hmS: els.hmS?.value, mH: els.mH?.value, mM: els.mM?.value, mS: els.mS?.value
        };
        saveStateDebounced(data);
      }
      function loadState(){
        try {
          const raw = localStorage.getItem(STATE_KEY);
          if (!raw) return;
          const d = JSON.parse(raw);
          Object.entries(d).forEach(([k,v]) => {
            if (k==='units') { if (els.units) els.units.value = v; return; }
            const el = els[k] || document.getElementById(`in-${k}`);
            if (el && v != null) el.value = v;
          });
        } catch(e){}
      }

      const HELP_KEY = 'sub3_v4_help_on';
      function setHelp(on){
        els.helpToggle.setAttribute('aria-pressed', String(on));
        document.querySelectorAll('details.help').forEach(d => d.open = on);
        try { localStorage.setItem(HELP_KEY, on ? '1' : '0'); } catch(e){}
      }
      function initHelp(){
        let on = false;
        try { on = localStorage.getItem(HELP_KEY) === '1'; } catch(e){}
        setHelp(on);
      }
      els.helpToggle?.addEventListener('click', () => {
        const next = els.helpToggle.getAttribute('aria-pressed') !== 'true';
        setHelp(next);
      });
      initHelp();

      function notify(msg, type='info'){
        const el = $('toast'); if (!el) return;
        el.textContent = msg;
        el.style.padding = '8px 12px';
        el.style.borderRadius = '8px';
        el.style.border = '1px solid var(--border-primary)';
        el.style.background = type==='error' ? 'rgba(239,68,68,.15)' : 'rgba(15,23,42,.9)';
        clearTimeout(el._t); el._t = setTimeout(()=>{ el.textContent=''; el.removeAttribute('style'); }, 2200);
      }

      const encodeS = (obj) => btoa(unescape(encodeURIComponent(JSON.stringify(obj))));
      const decodeS = (s) => { try { return JSON.parse(decodeURIComponent(escape(atob(s)))); } catch { return null; } };
      (function tryHydrateFromURL(){
        const qs = new URLSearchParams(location.search); const raw = qs.get('s'); if (!raw) return;
        const d = decodeS(raw); if (!d) return;
        Object.entries(d).forEach(([k,v]) => { const el = document.getElementById(`in-${k}`) || els[k]; if (el && v!=null) el.value = v; });
      })();

      function markInvalid(el, cond, hint){
        if (!el) return;
        el.setAttribute('aria-invalid', cond ? 'true' : 'false');
        if (cond && hint) el.title = hint; else el.removeAttribute('title');
      }
      function validateInputs(){
        markInvalid(els.k5s,  readNumber(els.k5s)  > 59 || readNumber(els.k5s)  < 0, 'Ï¥àÎäî 0‚Äì59');
        markInvalid(els.k10s, readNumber(els.k10s) > 59 || readNumber(els.k10s) < 0, 'Ï¥àÎäî 0‚Äì59');
        markInvalid(els.hmM,  readNumber(els.hmM)  > 59 || readNumber(els.hmM)  < 0, 'Î∂ÑÏùÄ 0‚Äì59');
        markInvalid(els.hmS,  readNumber(els.hmS)  > 59 || readNumber(els.hmS)  < 0, 'Ï¥àÎäî 0‚Äì59');
        markInvalid(els.mM,   readNumber(els.mM)   > 59 || readNumber(els.mM)   < 0, 'Î∂ÑÏùÄ 0‚Äì59');
        markInvalid(els.mS,   readNumber(els.mS)   > 59 || readNumber(els.mS)   < 0, 'Ï¥àÎäî 0‚Äì59');
      }

      function recommendSession(weatherKey){
        if (weatherKey==='hail' || weatherKey==='snow') return 'Ïã§ÎÇ¥ Easy 30‚Äì60‚Ä≤ + S&C';
        if (weatherKey==='heat') return 'Aerobic 40‚Äì70‚Ä≤(RPE 5~6) ¬∑ Î∞òÎ≥µÏàò 10‚Äì20%‚Üì';
        if (weatherKey==='wind') return 'ÌÖúÌè¨ ÎåÄÏã† Î£®ÌîÑÌòï Aerobic';
        if (weatherKey==='rain') return 'Ïù∏ÌÑ∞Î≤å‚ÜíÌä∏Î†àÎìúÎ∞Ä ÎòêÎäî ÌÖúÌè¨ Îã®Ïùº';
        return 'Í≥ÑÌöçÎåÄÎ°ú';
      }

      function getRiegelExp(pace10kSecPerKm){
        const mode = els.rMode?.value || 'auto';
        if (mode === 'manual'){
          const v = parseFloat(els.rExp?.value);
          return (v>=1.03 && v<=1.10) ? v : 1.06;
        }
        if (!Number.isFinite(pace10kSecPerKm) || pace10kSecPerKm<=0) return 1.06;
        if (pace10kSecPerKm <= 240) return 1.04; // ‚â§ 4:00/km
        if (pace10kSecPerKm >= 330) return 1.08; // ‚â• 5:30/km
        return 1.06;
      }

      function computeState(){
        const age = readNumber(els.age);
        const masters = age >= 40;
        const kg = readNumber(els.weight);
        const hCm = readNumber(els.height);
        const weatherKey = els.weather?.value || 'normal';
        const WR = WEATHER_RULES[weatherKey] || WEATHER_RULES.normal;

        const t5k = (() => normalizeMS(readNumber(els.k5m), readNumber(els.k5s)))();
        const t10k = (() => normalizeMS(readNumber(els.k10m), readNumber(els.k10s)))();
        const tHM = (() => {
          const h = readNumber(els.hmH), m = readNumber(els.hmM), s = readNumber(els.hmS);
          return (h>0||m>0||s>0) ? (h*3600 + normalizeMS(m, s)) : 0;
        })();
        const tM  = (() => {
          const h = readNumber(els.mH), m = readNumber(els.mM), s = readNumber(els.mS);
          return (h>0||m>0||s>0) ? (h*3600 + normalizeMS(m, s)) : 0;
        })();

        const D5=5, D10=10, DHM=21.0975, DM=42.195;
        let pace10=0, pace5=0, paceHM=0;
        if (t10k>0) pace10 = t10k/D10;
        else if (tHM>0) pace10 = (tHM*Math.pow(D10/DHM, getRiegelExp(tHM/DHM)))/D10;
        else if (t5k>0) pace10 = (t5k*Math.pow(D10/D5,  getRiegelExp(t5k/D5)))/D10;

        if (t5k>0) pace5 = t5k/D5;
        else if (t10k>0) pace5 = (t10k*Math.pow(D5/D10,  getRiegelExp(t10k/D10)))/D5;
        else if (tHM>0) pace5 = (tHM*Math.pow(D5/DHM,   getRiegelExp(tHM/DHM)))/D5;

        if (tHM>0) paceHM = tHM/DHM;
        else if (t10k>0) paceHM = (t10k*Math.pow(DHM/D10, getRiegelExp(t10k/D10)))/DHM;
        else if (t5k>0) paceHM = (t5k*Math.pow(DHM/D5,   getRiegelExp(t5k/D5)))/DHM;

        let mpSecPerKm = 0;
        if (tM>0) mpSecPerKm = tM/DM;
        else if (tHM>0) mpSecPerKm = (tHM*Math.pow(DM/DHM, getRiegelExp(pace10||300)))/DM;
        else if (t10k>0) mpSecPerKm = (t10k*Math.pow(DM/D10, getRiegelExp(pace10||300)))/DM;
        else if (t5k>0) mpSecPerKm = (t5k*Math.pow(DM/D5,  getRiegelExp(pace10||300)))/DM;

        const adjM = { easy: (masters?5:0), aer: (masters?5:0), t:(masters?5:0), cv:(masters?3:0) };
        const adjW = WR.paceAdj;

        let easyStr='‚Äî', aerStr='‚Äî', tStr='‚Äî', cvStr='‚Äî', mpStr='‚Äî', speedStr='‚Äî';
        if (mpSecPerKm>0) {
          const easyLo = mpSecPerKm + 60 + adjM.easy + adjW.easy;
          const easyHi = mpSecPerKm + 90 + adjM.easy + adjW.easy;
          const aerLo  = mpSecPerKm + 30 + adjM.aer  + adjW.aer;
          const aerHi  = mpSecPerKm + 60 + adjM.aer  + adjW.aer;
          easyStr = `${secToPaceStr(easyLo)}‚Äì${secToPaceStr(easyHi)}`;
          aerStr  = `${secToPaceStr(aerLo)}‚Äì${secToPaceStr(aerHi)}`;
          mpStr   = secToPaceStr(mpSecPerKm);
          const kmh = 3600 / mpSecPerKm;
          const mph = kmh / KM_PER_MILE;
          speedStr = getUnits()==='imperial' ? `${mph.toFixed(1)} mph` : `${kmh.toFixed(1)} km/h`;
        }
        if (paceHM>0) tStr = `${secToPaceStr(paceHM + 0 + adjW.t)}‚Äì${secToPaceStr(paceHM + 10 + adjM.t + adjW.t)}`;
        else if (pace10>0) tStr = `${secToPaceStr(pace10 + 10 + adjW.t)}‚Äì${secToPaceStr(pace10 + 15 + adjM.t + adjW.t)}`;

        if (pace5>0) cvStr = `${secToPaceStr(pace5 + 8 + adjW.cv)}‚Äì${secToPaceStr(pace5 + 12 + adjM.cv + adjW.cv)}`;
        else if (pace10>0) cvStr = `${secToPaceStr(pace10 + 0 + adjW.cv)}‚Äì${secToPaceStr(pace10 + 5 + adjM.cv + adjW.cv)}`;

        const cho = (kg>0) ? [clamp(kg*0.8,60,120), clamp(kg*1.0,60,120)] : null;
        const choStr = cho ? `${Math.round(cho[0])}‚Äì${Math.round(cho[1])} g/h${(weatherKey==='heat')?' (ÏÉÅÎã® Í∂åÏû•)':''}` : '60‚Äì90 g/h';

        let hydrStr = weatherKey==='heat' ? '0.6‚Äì1.0 L/h' : '0.4‚Äì0.8 L/h';
        if (kg>0){
          const [mlLo, mlHi] = WR.mlPerKg;
          const loL = clamp(kg*mlLo/1000, 0.3, 1.2);
          const hiL = clamp(kg*mlHi/1000, 0.3, 1.2);
          hydrStr = `${loL.toFixed(1)}‚Äì${hiL.toFixed(1)} L/h`;
        }
        const [naLo, naHi] = WR.na;
        const naStr = `${naLo}‚Äì${naHi} mg/h`;

        const [lrLo, lrHi] = WR.lrPct;
        const lrTxt = lrLo===lrHi ? `${lrLo}%` : `${lrLo}%~${lrHi}%`;

        const sess = recommendSession(weatherKey);

        const bmi = (hCm>0 && kg>0) ? (kg / Math.pow(hCm/100,2)).toFixed(1) : '‚Äî';

        return { masters, weatherKey, WR, mpStr, easyStr, aerStr, tStr, cvStr, choStr, hydrStr, naStr, lrTxt, sess, bmi, kpiMp: mpStr || '4:14‚Äì4:16', kpiCho: cho ? `${Math.round(cho[0])}‚Äì${Math.round(cho[1])}` : '60‚Äì90(120)', speedStr };
      }

      let rafId = null;
      function renderState(s){
        setText(els.outBMI, s.bmi);
        setText(els.outMP, s.mpStr || '‚Äî');
        setText(els.kpiMP, s.mpStr || '4:14‚Äì4:16');

        setText(els.outCHO, s.choStr);
        setText(els.kpiCHO, s.kpiCho);

        setText(els.outHydr, s.hydrStr);
        setText(els.outNa, s.naStr);

        setText(els.chipEasy, s.easyStr==='‚Äî' ? 'Easy(Í∞úÏù∏Ìôî): ‚Äî' : `Easy(Í∞úÏù∏Ìôî): ${s.easyStr}`);
        setText(els.chipAer,  s.aerStr==='‚Äî'  ? 'Aerobic(Í∞úÏù∏Ìôî): ‚Äî' : `Aerobic(Í∞úÏù∏Ìôî): ${s.aerStr}`);
        setText(els.chipT,    s.tStr==='‚Äî'    ? 'T(Í∞úÏù∏Ìôî): ‚Äî' : `T(Í∞úÏù∏Ìôî): ${s.tStr}`);
        setText(els.chipCV,   s.cvStr==='‚Äî'   ? 'CV(Í∞úÏù∏Ìôî): ‚Äî' : `CV(Í∞úÏù∏Ìôî): ${s.cvStr}`);

        if (els.wx.easy){
          setText(els.wx.easy, `+${s.WR.paceAdj.easy}`);
          setText(els.wx.aer,  `+${s.WR.paceAdj.aer}`);
          setText(els.wx.t,    `+${s.WR.paceAdj.t}`);
          setText(els.wx.cv,   `+${s.WR.paceAdj.cv}`);
          setText(els.wx.lr, s.lrTxt);
          setText(els.wx.indoor, s.WR.indoor);
          els.wx.tips.innerHTML = (s.WR.tips||[]).map(t=>`<li>${t}</li>`).join('');
          setText(els.wx.hydr, s.hydrStr);
          setText(els.wx.na, s.naStr);
          setText(els.wx.session, s.sess);
        }

        setText($('lr-advice-base'), s.lrTxt);
        setText($('lr-advice-spec'), s.lrTxt);

        setText(els.quick.mp, s.mpStr || '‚Äî');
        setText(els.quick.easy, s.easyStr || '‚Äî');
        setText(els.quick.t, s.tStr || '‚Äî');
        setText(els.quick.cv, s.cvStr || '‚Äî');
        setText(els.quick.cho, s.choStr || '‚Äî');
        setText(els.quick.hydr, s.hydrStr || '‚Äî');
        setText(els.quick.na, s.naStr || '‚Äî');
        setText(els.quick.speed, s.speedStr || '‚Äî');
        setText(els.quick.session, s.sess || '‚Äî');
        setText(els.quick.weather, ({normal:'Î≥¥ÌÜµ',heat:'ÎçîÏúÑ',cold:'Ï∂îÏúÑ',rain:'ÎπÑ',snow:'Îàà¬∑Í≤∞Îπô',hail:'Ïö∞Î∞ï¬∑ÏïÖÏ≤úÌõÑ',wind:'Í∞ïÌíç'})[s.weatherKey] || 'Î≥¥ÌÜµ');
        els.quick.masters.style.display = s.masters ? '' : 'none';
      }
      function calc(){
        if (rafId) cancelAnimationFrame(rafId);
        const state = computeState();
        rafId = requestAnimationFrame(() => { renderState(state); validateInputs(); saveState(); });
      }

      els.btnCopy?.addEventListener('click', async () => {
        const txt = [
          `MP: ${$('q-mp').textContent}`,
          `Easy: ${$('q-easy').textContent}`,
          `T: ${$('q-t').textContent}`,
          `CV: ${$('q-cv').textContent}`,
          `CHO: ${$('q-cho').textContent}`,
          `ÏàòÎ∂Ñ: ${$('q-hydr').textContent}`,
          `Na: ${$('q-na').textContent}`,
          `ÏÜçÎèÑ: ${$('q-speed').textContent}`,
          `ÏÑ∏ÏÖò: ${$('q-session').textContent}`,
          `ÎÇ†Ïî®: ${$('q-weather').textContent}${$('q-masters').style.display===''?' ¬∑ ÎßàÏä§ÌÑ∞Ïä§':''}`
        ].join('\n');
        try { await navigator.clipboard.writeText(txt); notify('ÏöîÏïΩÏù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§'); }
        catch(e) { window.prompt('ÏïÑÎûò ÎÇ¥Ïö©ÏùÑ Î≥µÏÇ¨ÌïòÏÑ∏Ïöî', txt); }
      });

      els.btnShare?.addEventListener('click', async () => {
        const data = {
          sex: els.sex?.value, age: els.age?.value, height: els.height?.value, weight: els.weight?.value, weather: els.weather?.value, units: getUnits(),
          rMode: els.rMode?.value, rExp: els.rExp?.value,
          k5m: els.k5m?.value, k5s: els.k5s?.value, k10m: els.k10m?.value, k10s: els.k10s?.value, hmH: els.hmH?.value, hmM: els.hmM?.value, hmS: els.hmS?.value, mH: els.mH?.value, mM: els.mM?.value, mS: els.mS?.value
        };
        const url = `${location.origin}${location.pathname}?s=${encodeS(data)}#panel-personalize`;
        try { await navigator.clipboard.writeText(url); notify('ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§'); }
        catch { window.prompt('ÎßÅÌÅ¨Î•º Î≥µÏÇ¨ÌïòÏÑ∏Ïöî', url); }
      });

      els.btnHideBar?.addEventListener('click', () => {
        const hidden = els.kbar.getAttribute('aria-hidden') === 'true' ? false : true;
        els.kbar.setAttribute('aria-hidden', String(hidden));
        els.btnHideBar.setAttribute('aria-expanded', String(!hidden));
        $('hidebar-ico').textContent = !hidden ? 'üûÇ' : 'üûÄ';
        $('hidebar-label').textContent = !hidden ? 'Ï†ëÍ∏∞' : 'ÌéºÏπòÍ∏∞';
      });

      $('calc-form')?.addEventListener('input', calc);
      $('calc-form')?.addEventListener('submit', (e)=> e.preventDefault());
      els.btnCalc?.addEventListener('click', calc);
      els.btnReset?.addEventListener('click', () => { try { localStorage.removeItem(STATE_KEY); } catch(e){} $('calc-form')?.reset(); calc(); });

      document.addEventListener('keydown', (e) => {
        if (e.target.matches('input,select,textarea')) return;
        if (e.key === '?' || (e.shiftKey && e.key === '/')) { e.preventDefault(); els.helpToggle?.click(); }
        if (e.key.toLowerCase() === 'p') { e.preventDefault(); $('tab-personalize')?.click(); }
        if (e.key.toLowerCase() === 'g') { e.preventDefault(); $('tab-glossary')?.click(); }
      });

      loadState();
      calc();
    });
  </script>
</body>
</html>
